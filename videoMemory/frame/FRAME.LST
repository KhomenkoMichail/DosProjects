Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 1
frame.asm



      1	0000			     .model tiny
      2	0000			     .code
      3
      4				     locals @@
      5				     org 100h
      6
      7	0100			     Start:
      8
      9	0100  E8 023E		     main:	     call initRegs
     10	0103  FC				     cld
     11
     12	0104  E8 0248				     call processCommandLineMessage
     13
     14	0107  E8 02E1				     call printfAnimatedFrame
     15
     16	010A  E8 00A5				     call printfCommandLineMessage
     17
     18	010D  B8 4C00				     mov ax, 4c00h
     19	0110  CD 21				     int 21h
     20
     21
     22
     23	0112			     hashSymbolStrlen	     proc
     24
     25	0112  32 D2					     xor dl, dl
     26	0114  AC		     continue:		     lodsb
     27
     28
     29	0115  3C 23					     cmp al, '#'
     30	0117  74 08					     je	endOfString
     31	0119  3C 0D					     cmp al, 0Dh
     32	011B  74 04					     je	 endOfString
     33
     34	011D  FE C2					     inc dl
     35	011F  EB F3					     jmp continue
     36
     37	0121  C3		     endOfString:	     ret
     38	0122			     hashSymbolStrlen	     endp
     39				     ;----------------------------------------------------------------------------------------------
     40				     ; Counts the number of characters from the	starting address to the	first '#' character
     41				     ;Entry: si	= string start address
     42				     ;Exit:  dl	= the number of	characters from	the starting address to	the first '#' character
     43				     ;Expected:	direction flag = 0
     44				     ;Destroyed: al, si, dl
     45				     ;----------------------------------------------------------------------------------------------
     46
     47
     48	0122			     getMessageParams	   proc
     49
     50							   ;mov	cl, al
     51
     52	0122  33 DB					   xor bx, bx
     53
     54	0124  E8 FFEB		     @@getNumOfStrings:	   call	hashSymbolStrlen
     55	0127  2A CA					   sub cl, dl
     56
     57	0129  80 F9 00					   cmp cl, 0
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 2
frame.asm



     58	012C  74 02					   je @@countIsZero
     59	012E  FE C9					   dec cl
     60	0130  FE C6		     @@countIsZero:	   inc dh
     61
     62	0132  3A DA					   cmp bl, dl
     63	0134  77 02					   ja  @@shortString
     64	0136  8A DA					   mov bl, dl
     65	0138  32 D2		     @@shortString:	   xor dl, dl
     66	013A  83 F9 00					   cmp cx, 0
     67	013D  75 E5		     @@notNewString:	   jne @@getNumOfStrings
     68
     69							 ;inc dh
     70
     71	013F  3A D3					 cmp dl, bl
     72	0141  77 02					 ja alreadyMaxLen
     73	0143  8A D3					 mov dl, bl
     74
     75	0145  C3		     alreadyMaxLen:	 ret
     76	0146			     getMessageParams	 endp
     77				     ;----------------------------------------------------------------------------------------------
     78				     ; Gets the	number of strings in a command line message and	the maximum length of those strings.
     79				     ;Entry: si	= command line message start address
     80				     ;	     cl	= command line message length
     81				     ;Exit:  dh	= the number of	strings	in a command line
     82				     ;	     dl	= the maximum length of	command	line message strings
     83				     ;Expected:
     84				     ;Destroyed: si, al, cx, bx, dx
     85				     ;----------------------------------------------------------------------------------------------
     86
     87	0146			     getVideoMemoryVerticalOffset	 proc
     88	0146  33 C0							 xor ax, ax
     89
     90	0148  BB 0019							 mov bx, 25
     91	014B  8A C6							 mov al, dh
     92	014D  98							 cbw
     93	014E  2B D8							 sub bx, ax
     94	0150  D1 EB							 shr bx, 1
     95	0152  B8 00A0							 mov ax, 160
     96	0155  52							 push dx
     97	0156  F7 E3							 mul bx
     98	0158  5A							 pop dx
     99	0159  8B D8							 mov bx, ax
    100
    101	015B  C3							 ret
    102	015C			     getVideoMemoryVerticalOffset	 endp
    103				     ;----------------------------------------------------------------------------------------------
    104				     ;Gets video memory	vertical position offset depending on the number of lines
    105				     ;in the command line message.
    106				     ;Entry: dh	= the number of	lines in the command line message.
    107				     ;Exit:  bx	= video	memory vertical	position offset
    108				     ;Expected:
    109				     ;Destroyed: ax, bx
    110				     ;----------------------------------------------------------------------------------------------
    111
    112	015C			     printfCentredString	 proc
    113
    114	015C  55						 push bp
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 3
frame.asm



    115	015D  8B EC						 mov bp, sp
    116
    117	015F  8B 76 04						 mov si, [bp+4]
    118	0162  8B 5E 06						 mov bx, [bp+6]
    119
    120	0165  33 FF						 xor di, di
    121
    122	0167  52						 push dx
    123	0168  E8 FFA7						 call hashSymbolStrlen
    124
    125	016B  8A C2						 mov al, dl
    126	016D  98						 cbw
    127	016E  8B F8						 mov di, ax
    128	0170  5A						 pop dx
    129
    130	0171  51						 push cx
    131	0172  8A C8						 mov cl, al
    132
    133	0174  2B F7						 sub si, di
    134	0176  4E						 dec si
    135
    136	0177  B8 0050						 mov ax, 80
    137	017A  2B C7						 sub ax, di
    138	017C  D1 E8						 shr ax, 1
    139	017E  D1 E0						 shl ax, 1
    140	0180  03 D8						 add bx, ax
    141
    142	0182  D1 E7						 shl di, 1
    143	0184  03 F8						 add di, ax
    144
    145	0186  56						 push si
    146	0187  51						 push cx
    147	0188  53						 push bx
    148	0189  E8 000B						 call myPuts
    149	018C  59						 pop cx
    150
    151	018D  2B DF						 sub bx, di
    152	018F  33 FF						 xor di, di
    153
    154	0191  8B C6						 mov ax, si
    155	0193  8B E5						 mov sp, bp
    156	0195  5D						 pop bp
    157	0196  C3						 ret
    158	0197			     printfCentredString	 endp
    159				     ;----------------------------------------------------------------------------------------------
    160				     ;Prints a string in the center of video memory line
    161				     ;Entry: [bp+4] = start address of the string
    162				     ;	     [bp+6] = video memory position offset
    163				     ;Exit:  ax	= end address of the string
    164				     ;Expected:	direction flag = 0, bx must be a multiple of 80d*2
    165				     ;Destroyed: di, ax, si
    166				     ;----------------------------------------------------------------------------------------------
    167
    168
    169	0197			     myPuts		 proc
    170	0197  55					 push bp
    171	0198  8B EC					 mov bp, sp
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 4
frame.asm



    172
    173	019A  8B 76 08					 mov si, [bp+8]
    174	019D  8B 4E 06					 mov cx, [bp+6]
    175	01A0  8B 5E 04					 mov bx, [bp+4]
    176
    177	01A3  AC		     @@next:		 lodsb
    178	01A4  26: 88 07					 mov es:[bx], al
    179	01A7  83 C3 02					 add bx, 2
    180	01AA  E2 F7					 loop @@next
    181
    182	01AC  8B E5					 mov sp, bp
    183	01AE  5D					 pop bp
    184	01AF  C2 0006					 ret 6
    185	01B2			     myPuts		 endp
    186				     ;----------------------------------------------------------------------------------------------
    187				     ;Prints a string of a given length
    188				     ;Entry: [bp+8] = start address of the string
    189				     ;	     [bp+6] = length of	the string
    190				     ;	     [bp+4] = video memory vertical position offset
    191				     ;Exit
    192				     ;Expected:	direction flag = 0
    193				     ;Destroyed: si, bx, al, cx
    194				     ;----------------------------------------------------------------------------------------------
    195
    196	01B2			     printfCommandLineMessage		proc
    197	01B2  8A CE						     mov cl, dh
    198	01B4  32 ED						     xor ch, ch
    199
    200	01B6  BE 0082						     mov si, 82h
    201	01B9  AC						     lodsb
    202	01BA  BE 0084						     mov si, 84h
    203
    204	01BD  3C 30						     cmp al, 30h
    205	01BF  75 03						     jne @@simpleMode
    206	01C1  83 C6 0D						     add si, 13d
    207
    208	01C4  E8 FF7F		     @@simpleMode:		     call getVideoMemoryVerticalOffset
    209
    210	01C7  53		     @@nextStr:			     push bx
    211	01C8  56						     push si
    212
    213	01C9  E8 FF90						     call printfCentredString
    214	01CC  5E						     pop si
    215	01CD  5B						     pop bx
    216
    217	01CE  8B F0						     mov si, ax
    218	01D0  46						     inc si
    219
    220	01D1  81 C3 00A0					     add bx, 80*2
    221	01D5  E2 F0						     loop @@nextStr
    222
    223	01D7  C3						     ret
    224	01D8			     printfCommandLineMessage		endp
    225				     ;----------------------------------------------------------------------------------------------
    226				     ;Prints a centered	command	line message
    227				     ;Entry: dh	= number of message lines
    228				     ;Exit:
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 5
frame.asm



    229				     ;Expected:	direction flag = 0
    230				     ;Destroyed: ax, bx, cx, si, di
    231				     ;----------------------------------------------------------------------------------------------
    232
    233	01D8			     getFrameVideoMemoryOffset	     proc
    234
    235	01D8  BF 0019						     mov di, 25
    236	01DB  8A C6						     mov al, dh
    237	01DD  98						     cbw
    238	01DE  2B F8						     sub di, ax
    239	01E0  D1 EF						     shr di, 1
    240	01E2  83 EF 03						     sub di, 3d
    241	01E5  B8 00A0						     mov ax, 160
    242	01E8  52						     push dx
    243	01E9  F7 E7						     mul di
    244	01EB  5A						     pop dx
    245	01EC  8B F8						     mov di, ax
    246
    247	01EE  33 C0						     xor ax, ax
    248	01F0  8A C2						     mov al, dl
    249	01F2  98						     cbw
    250
    251	01F3  BB 0050						     mov bx, 80
    252	01F6  2B D8						     sub bx, ax
    253	01F8  83 EB 06						     sub bx, 6d
    254	01FB  D1 EB						     shr bx, 1
    255	01FD  D1 E3						     shl bx, 1
    256	01FF  03 FB						     add di, bx
    257
    258	0201  C3						     ret
    259	0202			     getFrameVideoMemoryOffset	     endp
    260				     ;----------------------------------------------------------------------------------------------
    261				     ;Gets a video memory offset for frame background depending
    262				     ;on the number of lines and their length in the message
    263				     ;Entry: dh	= the number of	lines in the message
    264				     ;	     dl	= max length of	the string in the message
    265				     ;Exit:  di	= video	memory offset for frame	background
    266				     ;Expected:
    267				     ;Destroyed: ax, bx, di
    268				     ;----------------------------------------------------------------------------------------------
    269
    270	0202			     printfFrameBackgroundString	 proc
    271
    272	0202  26: 88 45	01	     @@printfByte:			 mov byte ptr es:[di+1], al
    273	0206  83 C7 02							 add di, 2
    274	0209  E2 F7							 loop @@printfByte
    275
    276	020B  C3							 ret
    277	020C			     printfFrameBackgroundString	 endp
    278				     ;----------------------------------------------------------------------------------------------
    279				     ;Prints frameBackground string a certain of color
    280				     ;Entry: di	= starting address of the string
    281				     ;	     al	= frame	color binary code
    282				     ;	     cl	= length of the	string
    283				     ;Exit:
    284				     ;Expected:	es contains the	address	of the video memory segment.
    285				     ;Destroyed: di, cl
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 6
frame.asm



    286				     ;----------------------------------------------------------------------------------------------
    287
    288	020C			     printfFrameBackground	     proc
    289	020C  50						     push ax
    290	020D  E8 FFC8						     call getFrameVideoMemoryOffset
    291	0210  58						     pop ax
    292
    293	0211  33 DB						     xor bx, bx
    294	0213  8A DE						     mov bl, dh
    295	0215  80 C3 06						     add bl, 6
    296
    297	0218  33 C9		     printfFrameStr:		     xor cx, cx
    298	021A  8A CA						     mov cl, dl
    299	021C  80 C1 06						     add cl, 6
    300
    301	021F  E8 FFE0						     call printfFrameBackgroundString
    302
    303	0222  81 C7 00A0					     add di, 160d
    304
    305	0226  50						     push ax
    306	0227  33 C0						     xor ax, ax
    307	0229  8A C2						     mov al, dl
    308	022B  98						     cbw
    309	022C  D1 E0						     shl ax, 1
    310	022E  2B F8						     sub di, ax
    311	0230  83 EF 0C						     sub di, 12
    312	0233  58						     pop ax
    313
    314	0234  FE CB						     dec bl
    315	0236  80 FB 00						     cmp bl, 0
    316	0239  75 DD						     jne printfFrameStr
    317
    318	023B  C3						     ret
    319	023C			     printfFrameBackground	     endp
    320				     ;----------------------------------------------------------------------------------------------
    321				     ;Prints frame centered frame background depending
    322				     ;on the number of lines and their length in the message
    323				     ;Entry: dh	= the number of	lines in the message
    324				     ;	     dl	= max length of	the string in the message
    325				     ;	     al	= frame	color binary code
    326				     ;Exit:
    327				     ;Expected:
    328				     ;Destroyed: bx, di, cl
    329				     ;----------------------------------------------------------------------------------------------
    330
    331	023C			     printHorizontalString   proc
    332	023C  BB 0002					     mov bx, 2
    333	023F  80 FC 00					     cmp ah, 0
    334	0242  74 02					     je	@@nextElem
    335	0244  F7 DB					     neg bx
    336
    337	0246  26: 88 05		     @@nextElem:	     mov byte ptr es:[di], al
    338	0249  03 FB					     add di, bx
    339	024B  E2 F9					     loop @@nextElem
    340
    341	024D  C3					     ret
    342
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 7
frame.asm



    343	024E			     printHorizontalString   endp
    344				     ;----------------------------------------------------------------------------------------------
    345				     ;Prints horizontal	string
    346				     ;Entry: al	= symbol binary	code
    347				     ;	     ah	= direction flag (a = 0, di += 2; a != 0, di -=	2)
    348				     ;	     di	= video	memory offset
    349				     ;	     cx	= length of string
    350				     ;Exit:
    351				     ;Expected:	es contains the	address	of the video memory segment.
    352				     ;Destroyed: cx, bx
    353				     ;----------------------------------------------------------------------------------------------
    354
    355	024E			     printVerticalString     proc
    356	024E  BB 00A0					     mov bx, 80d*2
    357	0251  80 FC 00					     cmp ah, 0
    358	0254  74 02					     je	@@nextElem
    359	0256  F7 DB					     neg bx
    360
    361	0258  26: 88 05		     @@nextElem:	     mov byte ptr es:[di], al
    362	025B  03 FB					     add di, bx
    363	025D  E2 F9					     loop @@nextElem
    364
    365	025F  C3					     ret
    366
    367	0260			     printVerticalString     endp
    368				     ;----------------------------------------------------------------------------------------------
    369				     ;Prints vertical string
    370				     ;Entry: al	= symbol binary	code
    371				     ;	     ah	= direction flag (a = 0, di += 2; a != 0, di -=	2)
    372				     ;	     di	= video	memory offset
    373				     ;	     cx	= length of string
    374				     ;Exit:
    375				     ;Expected:	es contains the	address	of the video memory segment.
    376				     ;Destroyed: cx, bx
    377				     ;----------------------------------------------------------------------------------------------
    378
    379	0260			     printfFrameForeground	     proc
    380	0260  BE 0082						     mov si, 82h
    381	0263  AC						     lodsb
    382	0264  8A E0						     mov ah, al
    383
    384	0266  81 EF 0140					     sub di, 160*2
    385	026A  83 C7 02						     add di, 2
    386
    387	026D  B0 C8						     mov al, 0C8h
    388	026F  80 FC 30						     cmp ah, 30h
    389	0272  75 04						     jne @@simpleChoice1
    390	0274  BE 008A						     mov si, 8Ah
    391	0277  AC						     lodsb
    392	0278  26: 88 05		     @@simpleChoice1:		     mov byte ptr es:[di], al
    393
    394	027B  83 C7 02						     add di, 2
    395
    396	027E  33 C9						     xor cx, cx
    397	0280  8A CA						     mov cl, dl
    398	0282  80 C1 02						     add cl, 2
    399
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 8
frame.asm



    400	0285  B0 CD						     mov al, 0CDh
    401	0287  80 FC 30						     cmp ah, 30h
    402	028A  75 04						     jne @@simpleChoice2
    403	028C  BE 008B						     mov si, 8Bh
    404	028F  AC						     lodsb
    405
    406	0290  50		     @@simpleChoice2:		     push ax
    407	0291  B4 00						     mov ah, 0
    408	0293  E8 FFA6						     call printHorizontalString
    409	0296  58						     pop ax
    410
    411	0297  B0 BC						     mov al, 0BCh
    412	0299  80 FC 30						     cmp ah, 30h
    413	029C  75 04						     jne @@simpleChoice3
    414	029E  BE 008C						     mov si, 8Ch
    415	02A1  AC						     lodsb
    416	02A2  26: 88 05		     @@simpleChoice3:		     mov byte ptr es:[di], al
    417
    418	02A5  8A C6						     mov al, dh
    419	02A7  04 03						     add al, 3
    420	02A9  50						     push ax
    421	02AA  98						     cbw
    422	02AB  BB 00A0						     mov bx, 160d
    423	02AE  52						     push dx
    424	02AF  F7 E3						     mul bx
    425	02B1  5A						     pop dx
    426	02B2  2B F8						     sub di, ax
    427	02B4  58						     pop ax
    428
    429	02B5  B0 BB						     mov al, 0BBh
    430	02B7  80 FC 30						     cmp ah, 30h
    431	02BA  75 04						     jne @@simpleChoice4
    432	02BC  BE 0086						     mov si, 86h
    433	02BF  AC						     lodsb
    434	02C0  26: 88 05		     @@simpleChoice4:		     mov byte ptr es:[di], al
    435
    436	02C3  83 EF 02						     sub di, 2
    437
    438	02C6  33 C9						     xor cx, cx
    439	02C8  8A CA						     mov cl, dl
    440	02CA  80 C1 02						     add cl, 2
    441	02CD  B0 CD						     mov al, 0CDh
    442	02CF  80 FC 30						     cmp ah, 30h
    443	02D2  75 04						     jne @@simpleChoice5
    444	02D4  BE 0085						     mov si, 85h
    445	02D7  AC						     lodsb
    446
    447	02D8  50		     @@simpleChoice5:		     push ax
    448	02D9  B4 01						     mov ah, 1
    449	02DB  E8 FF5E						     call printHorizontalString
    450	02DE  58						     pop ax
    451
    452	02DF  B0 C9						     mov al, 0C9h
    453	02E1  80 FC 30						     cmp ah, 30h
    454	02E4  75 04						     jne @@simpleChoice6
    455	02E6  BE 0084						     mov si, 84h
    456	02E9  AC						     lodsb
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 9
frame.asm



    457	02EA  26: 88 05		     @@simpleChoice6:		     mov byte ptr es:[di], al
    458	02ED  81 C7 00A0					     add di, 80d*2
    459
    460	02F1  8A CE						     mov cl, dh
    461	02F3  80 C1 02						     add cl, 2
    462	02F6  B0 BA						     mov al, 0BAh
    463	02F8  80 FC 30						     cmp ah, 30h
    464	02FB  75 04						     jne @@simpleChoice7
    465	02FD  BE 0087						     mov si, 87h
    466	0300  AC						     lodsb
    467
    468	0301  50		     @@simpleChoice7:		     push ax
    469	0302  B4 00						     mov ah, 0
    470	0304  E8 FF47						     call printVerticalString
    471	0307  58						     pop ax
    472
    473	0308  81 EF 00A0					     sub di, 80d*2
    474
    475	030C  50						     push ax
    476	030D  8A C2						     mov al, dl
    477	030F  04 03						     add al, 3
    478	0311  98						     cbw
    479	0312  D1 E0						     shl ax, 1
    480	0314  03 F8						     add di, ax
    481	0316  58						     pop ax
    482
    483	0317  8A CE						     mov cl, dh
    484	0319  80 C1 02						     add cl, 2
    485	031C  B0 BA						     mov al, 0BAh
    486	031E  80 FC 30						     cmp ah, 30h
    487	0321  75 04						     jne @@simpleChoice8
    488	0323  BE 0089						     mov si, 89h
    489	0326  AC						     lodsb
    490
    491	0327  50		     @@simpleChoice8:		     push ax
    492	0328  B4 01						     mov ah, 1
    493	032A  E8 FF21						     call printVerticalString
    494	032D  58						     pop ax
    495
    496	032E  81 C7 00A0					     add di, 2*80d
    497	0332  B0 00						     mov al, 0h
    498	0334  80 FC 30						     cmp ah, 30h
    499	0337  75 04						     jne @@printfInternal
    500	0339  BE 0088						     mov si, 88h
    501	033C  AC						     lodsb
    502	033D  E8 002F		     @@printfInternal:		     call printInternalFrame
    503
    504	0340  C3						     ret
    505	0341			     printfFrameForeground	     endp
    506				     ;----------------------------------------------------------------------------------------------
    507				     ;Prints centered frame foreground depending
    508				     ;on the number of lines and their length in the message
    509				     ;Entry: dh	= the number of	lines in the message
    510				     ;	     dl	= max length of	the string in the message
    511				     ;	     di	= video	memory offset of the lower right corner	of the frame
    512				     ;Exit:
    513				     ;Expected:	es contains the	address	of the video memory segment.
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 10
frame.asm



    514				     ;Destroyed: ax, bx, cx, si, di
    515				     ;----------------------------------------------------------------------------------------------
    516
    517	0341			     initRegs		     proc
    518	0341  B8 B800					     mov ax, 0b800h
    519	0344  8E C0					     mov es, ax
    520
    521	0346  33 C0					     xor ax, ax
    522	0348  33 DB					     xor bx, bx
    523	034A  33 C9					     xor cx, cx
    524	034C  33 D2					     xor dx, dx
    525
    526	034E  C3					     ret
    527	034F			     initRegs		     endp
    528				     ;----------------------------------------------------------------------------------------------
    529				     ;Inits regs.
    530				     ;Entry:
    531				     ;Exit:
    532				     ;Expected:
    533				     ;Destroyed: ax, bx, cx, dx, es
    534				     ;----------------------------------------------------------------------------------------------
    535
    536	034F			     processCommandLineMessage		 proc
    537	034F  BE 0080							 mov si, 80h
    538	0352  AC							 lodsb
    539
    540	0353  8A C8							 mov cl, al
    541
    542	0355  BE 0082							 mov si, 82h
    543	0358  AC							 lodsb
    544
    545	0359  46							 inc si
    546	035A  80 E9 03							 sub cl, 3
    547
    548	035D  2C 30							 sub al, 30h
    549	035F  3C 00							 cmp al, 0
    550	0361  75 06							 jne @@simpleMode
    551	0363  83 C6 0D							 add si, 13d
    552	0366  80 E9 0D							 sub cl, 13d
    553
    554	0369  56		     @@simpleMode:			 push si
    555	036A  E8 FDB5							 call getMessageParams
    556	036D  5E							 pop si
    557
    558	036E  C3							 ret
    559
    560	036F			     processCommandLineMessage		 endp
    561				     ;----------------------------------------------------------------------------------------------
    562				     ;Сalculates position and gets params of a	centered command line message
    563				     ;Entry:
    564				     ;Exit:
    565				     ;Expected:	direction flag = 0.
    566				     ;Destroyed: ax, bx, cx, si
    567				     ;----------------------------------------------------------------------------------------------
    568
    569	036F			     printInternalFrame		     proc
    570
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 11
frame.asm



    571	036F  83 EF 02						     sub di, 2
    572	0372  8A CA						     mov cl, dl
    573	0374  80 C1 02						     add cl, 2
    574	0377  B4 01						     mov ah, 1
    575	0379  E8 FEC0						     call printHorizontalString
    576
    577	037C  83 C7 02						     add di, 2
    578	037F  8A CE						     mov cl, dh
    579	0381  80 C1 02						     add cl, 2
    580	0384  B4 00						     mov ah, 0
    581	0386  E8 FEC5						     call printVerticalString
    582
    583	0389  81 EF 00A0					     sub di, 2*80d
    584	038D  8A CA						     mov cl, dl
    585	038F  80 C1 02						     add cl, 2
    586	0392  B4 00						     mov ah, 0
    587	0394  E8 FEA5						     call printHorizontalString
    588
    589	0397  83 EF 02						     sub di, 2
    590	039A  8A CE						     mov cl, dh
    591	039C  80 C1 02						     add cl, 2
    592	039F  B4 01						     mov ah, 1
    593	03A1  E8 FEAA						     call printVerticalString
    594
    595	03A4  C3						     ret
    596	03A5			     printInternalFrame		     endp
    597				     ;----------------------------------------------------------------------------------------------
    598				     ;Prints centered internal frame foreground	depending
    599				     ;on the number of lines and their length in the message
    600				     ;Entry: al	= internal frame symbol	ascii-code
    601				     ;	     dh	= the number of	lines in the message
    602				     ;	     dl	= max length of	the string in the message
    603				     ;	     di	= video	memory offset of the upper right corner	of the frame
    604				     ;Exit:
    605				     ;Expected:	es contains the	address	of the video memory segment.
    606				     ;Destroyed: ax, cx, si, di
    607				     ;----------------------------------------------------------------------------------------------
    608
    609	03A5			     getFrameColor	     proc
    610	03A5  B0 70					     mov al, 01110000b
    611	03A7  BE 0082					     mov si, 82h
    612	03AA  8A 1C					     mov bl, [si]
    613	03AC  80 FB 30					     cmp bl, 30h
    614	03AF  75 23					     jne @@end
    615
    616	03B1  BE 008E					     mov si, 8Eh
    617	03B4  AC					     lodsb
    618	03B5  2C 30					     sub al, 30h
    619	03B7  3C 0A					     cmp al, 10d
    620	03B9  72 02					     jb	@@less10_1
    621	03BB  2C 07					     sub al, 7d
    622	03BD  D0 E0 D0 E0 D0 E0	D0+  @@less10_1:	     shl al, 4
    623	      E0
    624
    625	03C5  8A 1C					     mov bl, [si]
    626	03C7  80 EB 30					     sub bl, 30h
    627	03CA  80 FB 0A					     cmp bl, 10d
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 12
frame.asm



    628	03CD  72 03					     jb	@@less10_2
    629	03CF  80 EB 07					     sub bl, 7d
    630	03D2  02 C3		     @@less10_2:	     add al, bl
    631
    632	03D4  C3		     @@end:		     ret
    633	03D5			     getFrameColor	     endp
    634				     ;----------------------------------------------------------------------------------------------
    635				     ;Gets the color attribute of the frame depending on the selected mode
    636				     ;Entry:
    637				     ;Exit:  al	= color	attribute of the frame
    638				     ;Expected:	 [82h] = frame mode
    639				     ;		 [8Eh] and [8Fh] = hex color code
    640				     ;Destroyed: al, bl, si
    641				     ;----------------------------------------------------------------------------------------------
    642
    643	03D5			     printfFrame	     proc
    644	03D5  E8 FFCD					     call getFrameColor
    645
    646	03D8  E8 FE31					     call printfFrameBackground
    647
    648	03DB  E8 FE82					     call printfFrameForeground
    649	03DE  C3					     ret
    650
    651	03DF			     printfFrame	     endp
    652				     ;----------------------------------------------------------------------------------------------
    653				     ;Prints a centered	frame.
    654				     ;Entry: dh	= the number of	lines in the message
    655				     ;	     dl	= max length of	the string in the message
    656				     ;Exit:
    657				     ;Expected:	direction flag = 0, es contains	the address of the video memory	segment,
    658				     ;		[82h] =	frame mode.
    659				     ;Destroyed: ax, bx, cx, si, di
    660				     ;----------------------------------------------------------------------------------------------
    661
    662	03DF			     wait0_5seс	      proc
    663	03DF  B9 0007					     mov  cx, 7d
    664	03E2  BA A120					     mov  dx, 41248d
    665	03E5  B8 8600					     mov  ax, 8600h
    666	03E8  CD 15					     int  15h
    667
    668	03EA  C3					     ret
    669	03EB			     wait0_5seс	      endp
    670				     ;----------------------------------------------------------------------------------------------
    671				     ;Pauses for half a	second.
    672				     ;Entry:
    673				     ;Exit:
    674				     ;Expected:
    675				     ;Destroyed: ax, cx, dx
    676				     ;----------------------------------------------------------------------------------------------
    677
    678	03EB			     printfAnimatedFrame     proc
    679	03EB  33 C9					     xor cx, cx
    680	03ED  8A CA					     mov cl, dl
    681	03EF  B2 01					     mov dl, 1
    682
    683	03F1  51		     @@animation:	     push cx
    684	03F2  E8 FFE0					     call printfFrame
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 13
frame.asm



    685	03F5  52					     push dx
    686	03F6  E8 FFE6					     call wait0_5seс
    687	03F9  5A					     pop dx
    688	03FA  59					     pop cx
    689	03FB  80 C2 02					     add dl, 2
    690	03FE  3A D1					     cmp dl, cl
    691	0400  76 EF					     jbe @@animation
    692
    693	0402  FE CA					     dec dl
    694
    695	0404  C3					     ret
    696
    697	0405			     printfAnimatedFrame     endp
    698				     ;----------------------------------------------------------------------------------------------
    699				     ;Creates an animation of drawing a	centered frame.
    700				     ;Entry: dh	= the number of	lines in the message
    701				     ;	     dl	= max length of	the string in the message
    702				     ;Exit:
    703				     ;Expected:	direction flag = 0, es contains	the address of the video memory	segment,
    704				     ;		[82h] =	frame mode.
    705				     ;Destroyed: ax, bx, cx, si, di
    706				     ;----------------------------------------------------------------------------------------------
    707
    708				     end Start
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 14
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/17/26"
??FILENAME			  Text	 "frame	  "
??TIME				  Text	 "13:30:15"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@ANIMATION			  Near	 DGROUP:03F1
@@COUNTISZERO			  Near	 DGROUP:0130
@@END				  Near	 DGROUP:03D4
@@GETNUMOFSTRINGS		  Near	 DGROUP:0124
@@LESS10_1			  Near	 DGROUP:03BD
@@LESS10_2			  Near	 DGROUP:03D2
@@NEXT				  Near	 DGROUP:01A3
@@NEXTELEM			  Near	 DGROUP:0246
@@NEXTELEM			  Near	 DGROUP:0258
@@NEXTSTR			  Near	 DGROUP:01C7
@@NOTNEWSTRING			  Near	 DGROUP:013D
@@PRINTFBYTE			  Near	 DGROUP:0202
@@PRINTFINTERNAL		  Near	 DGROUP:033D
@@SHORTSTRING			  Near	 DGROUP:0138
@@SIMPLECHOICE1			  Near	 DGROUP:0278
@@SIMPLECHOICE2			  Near	 DGROUP:0290
@@SIMPLECHOICE3			  Near	 DGROUP:02A2
@@SIMPLECHOICE4			  Near	 DGROUP:02C0
@@SIMPLECHOICE5			  Near	 DGROUP:02D8
@@SIMPLECHOICE6			  Near	 DGROUP:02EA
@@SIMPLECHOICE7			  Near	 DGROUP:0301
@@SIMPLECHOICE8			  Near	 DGROUP:0327
@@SIMPLEMODE			  Near	 DGROUP:01C4
@@SIMPLEMODE			  Near	 DGROUP:0369
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 FRAME
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
ALREADYMAXLEN			  Near	 DGROUP:0145
CONTINUE			  Near	 DGROUP:0114
ENDOFSTRING			  Near	 DGROUP:0121
GETFRAMECOLOR			  Near	 DGROUP:03A5
GETFRAMEVIDEOMEMORYOFFSET	  Near	 DGROUP:01D8
GETMESSAGEPARAMS		  Near	 DGROUP:0122
GETVIDEOMEMORYVERTICALOFFSET	  Near	 DGROUP:0146
HASHSYMBOLSTRLEN		  Near	 DGROUP:0112
INITREGS			  Near	 DGROUP:0341
MAIN				  Near	 DGROUP:0100
MYPUTS				  Near	 DGROUP:0197
PRINTFANIMATEDFRAME		  Near	 DGROUP:03EB
PRINTFCENTREDSTRING		  Near	 DGROUP:015C
PRINTFCOMMANDLINEMESSAGE	  Near	 DGROUP:01B2
Turbo Assembler	 Version 4.1	    02/17/26 13:30:15	    Page 15
Symbol Table



PRINTFFRAME			  Near	 DGROUP:03D5
PRINTFFRAMEBACKGROUND		  Near	 DGROUP:020C
PRINTFFRAMEBACKGROUNDSTRING	  Near	 DGROUP:0202
PRINTFFRAMEFOREGROUND		  Near	 DGROUP:0260
PRINTFFRAMESTR			  Near	 DGROUP:0218
PRINTHORIZONTALSTRING		  Near	 DGROUP:023C
PRINTINTERNALFRAME		  Near	 DGROUP:036F
PRINTVERTICALSTRING		  Near	 DGROUP:024E
PROCESSCOMMANDLINEMESSAGE	  Near	 DGROUP:034F
START				  Near	 DGROUP:0100
WAIT0_5SEс			  Near	 DGROUP:03DF

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  0405 Word	  Public  CODE
