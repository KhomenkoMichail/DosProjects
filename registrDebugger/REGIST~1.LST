Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 1
regist~1.asm



      1				     .286
      2	0000			     .model tiny
      3	0000			     .code
      4				     org 100h
      5				     locals @@
      6
      7	0100			     Start:
      8	0100  E8 003D				     call replace09Int
      9	0103  E8 005D				     call replace08Int
     10
     11	0106  9C				     pushf
     12	0107  0E				     push cs
     13	0108  E8 000F				     call registersDebugger09Int
     14
     15	010B  E8 0000				     call endResidentProgram
     16
     17
     18	010E			     endResidentProgram		 proc
     19
     20	010E  B8 3100						 mov ax, 3100h
     21	0111  BA 057Fr						 mov dx, offset	endOfProgram
     22	0114  C1 EA 04						 shr dx, 4
     23	0117  42						 inc dx
     24	0118  CD 21						 int 21h
     25
     26	011A			     endResidentProgram		 endp
     27				     ;-----------------------------------------------------------------------------------------------
     28				     -
     29				     ;Ends resident program.
     30				     ;Entry:
     31				     ;Exit:
     32				     ;Expected:	The label "endOfProgram" is located at the end of the code.
     33				     ;Destroyed: ax, dx
     34				     ;-----------------------------------------------------------------------------------------------
     35				     -
     36
     37	011A			     registersDebugger09Int	 proc
     38	011A  50 53 06						 push ax bx es
     39
     40	011D  E4 60						 in al,	60h
     41	011F  3C 57						 cmp al, 'W'
     42	0121  75 07						 jne @@normalMode
     43	0123  2E: C6 06	057Er 01  +				 mov cs:printfRegsFlag,	1h
     44	      90
     45
     46	012A  E4 61		     @@normalMode:		 in al,	61h
     47	012C  0C 80						 or al,	80h
     48	012E  E6 61						 out 61h, al
     49	0130  24 7F						 and al, not 80h
     50	0132  E6 61						 out 61h, al
     51
     52	0134  B0 20						 mov al, 20h
     53	0136  E6 20						 out 20h, al
     54
     55	0138  07 5B 58						 pop es	bx ax
     56
     57	013B  EA						 db 0eah
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 2
regist~1.asm



     58	013C  0000		     old09ofs			 dw 0
     59	013E  0000		     old09seg			 dw 0
     60
     61	0140			     registersDebugger09Int	 endp
     62				     ;-----------------------------------------------------------------------------------------------
     63				     -
     64				     ;New 09 interrupt,	which raises the printfRegsFlag	to 1, when a key F11 is	pressed.
     65				     ;Entry:
     66				     ;Exit:
     67				     ;Expected:Old 09 interrupt	was replaced to	this function,
     68				     ;old09ofs contains	it's old segment and old09ofs contains it's old	offset.
     69				     ;Destroyed:
     70				     ;-----------------------------------------------------------------------------------------------
     71				     -
     72
     73
     74	0140			     replace09Int		 proc
     75	0140  B8 3509						 mov ax, 3509h
     76	0143  CD 21						 int 21h
     77
     78	0145  89 1E 013Cr					 mov old09ofs, bx
     79	0149  8C C3						 mov bx, es
     80	014B  89 1E 013Er					 mov old09seg, bx
     81
     82	014F  6A 00						 push 0
     83	0151  07						 pop es
     84
     85	0152  BB 0024						 mov bx, 4*09h
     86	0155  FA						 cli
     87	0156  26: C7 07	011Ar					 mov es:[bx], offset registersDebugger09Int
     88	015B  8C C8						 mov ax, cs
     89	015D  26: 89 47	02					 mov es:[bx+2],	ax
     90	0161  FB						 sti
     91
     92	0162  C3						 ret
     93	0163			     replace09Int		 endp
     94				     ;-----------------------------------------------------------------------------------------------
     95				     -
     96				     ;Replaces interrupt 9 with	a function registersDebugger09Int.
     97				     ;Entry:
     98				     ;Exit:
     99				     ;Expected:
    100				     ;Destroyed: ax, bx, es
    101				     ;-----------------------------------------------------------------------------------------------
    102				     -
    103
    104	0163			     replace08Int		 proc
    105
    106	0163  B8 3508						 mov ax, 3508h
    107	0166  CD 21						 int 21h
    108
    109	0168  89 1E 02BBr					 mov old08ofs, bx
    110	016C  8C C3						 mov bx, es
    111	016E  89 1E 02BDr					 mov old08seg, bx
    112
    113	0172  6A 00						 push 0
    114	0174  07						 pop es
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 3
regist~1.asm



    115
    116	0175  BB 0020						 mov bx, 4*08h
    117	0178  FA						 cli
    118	0179  26: C7 07	0186r					 mov es:[bx], offset printfRegs08Int
    119	017E  8C C8						 mov ax, cs
    120	0180  26: 89 47	02					 mov es:[bx+2],	ax
    121	0184  FB						 sti
    122
    123	0185  C3						 ret
    124	0186			     replace08Int		 endp
    125				     ;-----------------------------------------------------------------------------------------------
    126				     -
    127				     ;Replaces interrupt 8 with	a function printfRegs08Int.
    128				     ;Entry:
    129				     ;Exit:
    130				     ;Expected:
    131				     ;Destroyed: ax, bx, es
    132				     ;-----------------------------------------------------------------------------------------------
    133				     -
    134
    135
    136	0186			     printfRegs08Int		 proc
    137	0186  2E: 80 3E	057Er 00				 cmp cs:printfRegsFlag,	0h
    138	018C  75 03						 jne @@continue
    139	018E  E9 0129						 jmp @@end
    140
    141	0191  50 53 51 52 56 57	55+  @@continue:		 push ax bx cx dx si di	bp ds es ss
    142	      1E 06 16
    143	019B  8B EC						 mov bp, sp
    144
    145	019D  68 B800						 push 0b800h
    146	01A0  07						 pop es
    147	01A1  BB 0402						 mov bx, (80d*6+33d)*2
    148
    149	01A4  26: C6 07	61					 mov byte ptr es:[bx], 'a'
    150	01A8  26: C6 47	02 78					 mov byte ptr es:[bx+2], 'x'
    151	01AD  E8 010F						 call printfHexRegValue
    152
    153	01B0  81 C3 00A0					 add bx, 80d*2
    154	01B4  26: C6 07	62					 mov byte ptr es:[bx], 'b'
    155	01B8  26: C6 47	02 78					 mov byte ptr es:[bx+2], 'x'
    156	01BD  8B 46 10						 mov ax, [bp+16]
    157	01C0  E8 00FC						 call printfHexRegValue
    158
    159	01C3  81 C3 00A0					 add bx, 80d*2
    160	01C7  26: C6 07	63					 mov byte ptr es:[bx], 'c'
    161	01CB  26: C6 47	02 78					 mov byte ptr es:[bx+2], 'x'
    162	01D0  8B 46 0E						 mov ax, [bp+14]
    163	01D3  E8 00E9						 call printfHexRegValue
    164
    165	01D6  81 C3 00A0					 add bx, 80d*2
    166	01DA  26: C6 07	64					 mov byte ptr es:[bx], 'd'
    167	01DE  26: C6 47	02 78					 mov byte ptr es:[bx+2], 'x'
    168	01E3  8B 46 0C						 mov ax, [bp+12]
    169	01E6  E8 00D6						 call printfHexRegValue
    170
    171	01E9  81 C3 00A0					 add bx, 80d*2
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 4
regist~1.asm



    172	01ED  26: C6 07	73					 mov byte ptr es:[bx], 's'
    173	01F1  26: C6 47	02 69					 mov byte ptr es:[bx+2], 'i'
    174	01F6  8B 46 0A						 mov ax, [bp+10]
    175	01F9  E8 00C3						 call printfHexRegValue
    176
    177	01FC  81 C3 00A0					 add bx, 80d*2
    178	0200  26: C6 07	64					 mov byte ptr es:[bx], 'd'
    179	0204  26: C6 47	02 69					 mov byte ptr es:[bx+2], 'i'
    180	0209  8B 46 08						 mov ax, [bp+8]
    181	020C  E8 00B0						 call printfHexRegValue
    182
    183	020F  81 C3 00A0					 add bx, 80d*2
    184	0213  26: C6 07	62					 mov byte ptr es:[bx], 'b'
    185	0217  26: C6 47	02 70					 mov byte ptr es:[bx+2], 'p'
    186	021C  8B 46 06						 mov ax, [bp+6]
    187	021F  E8 009D						 call printfHexRegValue
    188
    189	0222  81 C3 00A0					 add bx, 80d*2
    190	0226  26: C6 07	73					 mov byte ptr es:[bx], 's'
    191	022A  26: C6 47	02 70					 mov byte ptr es:[bx+2], 'p'
    192	022F  8B C4						 mov ax, sp
    193	0231  2D 001A						 sub ax, 13d*2
    194	0234  E8 0088						 call printfHexRegValue
    195
    196	0237  81 C3 00A0					 add bx, 80d*2
    197	023B  26: C6 07	64					 mov byte ptr es:[bx], 'd'
    198	023F  26: C6 47	02 73					 mov byte ptr es:[bx+2], 's'
    199	0244  8B 46 04						 mov ax, [bp+4]
    200	0247  E8 0075						 call printfHexRegValue
    201
    202	024A  81 C3 00A0					 add bx, 80d*2
    203	024E  26: C6 07	65					 mov byte ptr es:[bx], 'e'
    204	0252  26: C6 47	02 73					 mov byte ptr es:[bx+2], 's'
    205	0257  8B 46 02						 mov ax, [bp+2]
    206	025A  E8 0062						 call printfHexRegValue
    207
    208	025D  81 C3 00A0					 add bx, 80d*2
    209	0261  26: C6 07	73					 mov byte ptr es:[bx], 's'
    210	0265  26: C6 47	02 73					 mov byte ptr es:[bx+2], 's'
    211	026A  8B 46 00						 mov ax, [bp]
    212	026D  E8 004F						 call printfHexRegValue
    213
    214	0270  81 C3 00A0					 add bx, 80d*2
    215	0274  26: C6 07	63					 mov byte ptr es:[bx], 'c'
    216	0278  26: C6 47	02 73					 mov byte ptr es:[bx+2], 's'
    217	027D  8B 46 16						 mov ax, [bp+22]
    218	0280  E8 003C						 call printfHexRegValue
    219
    220	0283  81 C3 00A0					 add bx, 80d*2
    221	0287  26: C6 07	69					 mov byte ptr es:[bx], 'i'
    222	028B  26: C6 47	02 70					 mov byte ptr es:[bx+2], 'p'
    223	0290  8B 46 14						 mov ax, [bp+20]
    224	0293  E8 0029						 call printfHexRegValue
    225
    226	0296  8B 46 18						 mov ax, [bp+24]
    227	0299  81 EB 0780					 sub bx, 80d*2*12d
    228	029D  83 C3 16						 add bx, 11d*2
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 5
regist~1.asm



    229	02A0  E8 006F						 call printfFlags
    230
    231	02A3  B6 0D						 mov dh, 13d
    232	02A5  B2 0E						 mov dl, 14d
    233	02A7  B0 30						 mov al, 30h
    234
    235	02A9  E8 0298						 call printfRegistersFrame
    236
    237	02AC  B0 20						 mov al, 20h
    238	02AE  E6 20						 out 20h, al
    239
    240	02B0  17 07 1F 5D 5F 5E	5A+				 pop ss	es ds bp di si dx cx bx	ax
    241	      59 5B 58
    242
    243	02BA  EA		     @@end:			 db 0eah
    244	02BB  0000		     old08ofs			 dw 0
    245	02BD  0000		     old08seg			 dw 0
    246
    247	02BF			     printfRegs08Int		 endp
    248				     ;-----------------------------------------------------------------------------------------------
    249				     -
    250				     ;New 08 interrupt,	which prints the updated values	​​of the processor registers
    251				     ;and flags	in a frame at each tick	of the system timer.
    252				     ;Entry:
    253				     ;Exit:
    254				     ;Expected:Old 08 interrupt	was replaced to	this function,
    255				     ;old08ofs contains	it's old segment and old08ofs contains it's old	offset.
    256				     ;Destroyed:
    257				     ;-----------------------------------------------------------------------------------------------
    258				     -
    259
    260
    261	02BF			     printfHexRegValue		 proc
    262
    263	02BF  33 D2						 xor dx, dx
    264	02C1  8A D4						 mov dl, ah
    265	02C3  C0 EA 04						 shr dl, 4h
    266
    267	02C6  80 C2 30						 add dl, 30h
    268	02C9  80 FA 39						 cmp dl, 39h
    269	02CC  76 03						 jbe @@notLetter1
    270	02CE  80 C2 07						 add dl, 7h
    271
    272	02D1  26: 88 57	06	     @@notLetter1:		 mov byte ptr es:[bx+6], dl
    273
    274	02D5  8A D4						 mov dl, ah
    275	02D7  80 E2 0F						 and dl, 00001111b
    276	02DA  80 C2 30						 add dl, 30h
    277	02DD  80 FA 39						 cmp dl, 39h
    278	02E0  76 03						 jbe @@notLetter2
    279	02E2  80 C2 07						 add dl, 7h
    280
    281	02E5  26: 88 57	08	     @@notLetter2:		 mov byte ptr es:[bx+8], dl
    282
    283	02E9  8A D0						 mov dl, al
    284	02EB  C0 EA 04						 shr dl, 4h
    285
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 6
regist~1.asm



    286	02EE  80 C2 30						 add dl, 30h
    287	02F1  80 FA 39						 cmp dl, 39h
    288	02F4  76 03						 jbe @@notLetter3
    289	02F6  80 C2 07						 add dl, 7h
    290
    291	02F9  26: 88 57	0A	     @@notLetter3:		 mov byte ptr es:[bx+10d], dl
    292
    293	02FD  8A D0						 mov dl, al
    294	02FF  80 E2 0F						 and dl, 00001111b
    295	0302  80 C2 30						 add dl, 30h
    296	0305  80 FA 39						 cmp dl, 39h
    297	0308  76 03						 jbe @@notLetter4
    298	030A  80 C2 07						 add dl, 7h
    299
    300	030D  26: 88 57	0C	     @@notLetter4:		 mov byte ptr es:[bx+12d], dl
    301
    302	0311  C3						 ret
    303	0312			     printfHexRegValue		 endp
    304				     ;-----------------------------------------------------------------------------------------------
    305				     -
    306				     ;Writes the hexadecimal value of the register to the video	memory
    307				     ;Entry: ax	= current register value
    308				     ;	     bx	= video	memory offset of the beginning of the inscription reduced by 6 bytes
    309				     ;	     (the first	6 bytes	are used to write the register name)
    310				     ;Exit:
    311				     ;Expected:	es contains video memory segment
    312				     ;Destroyed: dx
    313				     ;-----------------------------------------------------------------------------------------------
    314				     -
    315
    316	0312			     printfFlags	     proc
    317
    318	0312  8B FB					     mov di, bx
    319	0314  50 53					     push ax bx
    320	0316  E8 0088					     call printfFlagsColumn
    321	0319  5B 58					     pop bx ax
    322
    323	031B  83 C3 04					     add bx, 4h
    324
    325	031E  8B D0					     mov dx, ax
    326	0320  83 E2 01					     and dx, 0000000000000001b
    327	0323  83 FA 00					     cmp dx, 0
    328	0326  74 04					     je	@@zeroCF
    329	0328  26: C6 07	31				     mov byte ptr es:[bx], '1'
    330	032C			     @@zeroCF:
    331
    332	032C  8B D0					     mov dx, ax
    333	032E  83 E2 40					     and dx, 0000000001000000b
    334	0331  83 FA 00					     cmp dx, 0
    335	0334  74 06					     je	@@zeroZF
    336	0336  26: C6 87	00A0 31				     mov byte ptr es:[bx + 80d*2], '1'
    337	033C			     @@zeroZF:
    338	033C  8B D0					     mov dx, ax
    339	033E  81 E2 0080				     and dx, 0000000010000000b
    340	0342  83 FA 00					     cmp dx, 0
    341	0345  74 06					     je	@@zeroSF
    342	0347  26: C6 87	0140 31				     mov byte ptr es:[bx + 80d*2*2], '1'
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 7
regist~1.asm



    343	034D			     @@zeroSF:
    344	034D  8B D0					     mov dx, ax
    345	034F  81 E2 0800				     and dx, 0000100000000000b
    346	0353  83 FA 00					     cmp dx, 0
    347	0356  74 06					     je	@@zeroOF
    348	0358  26: C6 87	01E0 31				     mov byte ptr es:[bx + 80d*2*3], '1'
    349	035E			     @@zeroOF:
    350	035E  8B D0					     mov dx, ax
    351	0360  83 E2 04					     and dx, 0000000000000100b
    352	0363  83 FA 00					     cmp dx, 0
    353	0366  74 06					     je	@@zeroPF
    354	0368  26: C6 87	0280 31				     mov byte ptr es:[bx + 80d*2*4], '1'
    355	036E			     @@zeroPF:
    356	036E  8B D0					     mov dx, ax
    357	0370  83 E2 10					     and dx, 0000000000010000b
    358	0373  83 FA 00					     cmp dx, 0
    359	0376  74 06					     je	@@zeroAF
    360	0378  26: C6 87	0320 31				     mov byte ptr es:[bx + 80d*2*5], '1'
    361	037E			     @@zeroAF:
    362	037E  8B D0					     mov dx, ax
    363	0380  81 E2 0200				     and dx, 0000001000000000b
    364	0384  83 FA 00					     cmp dx, 0
    365	0387  74 06					     je	@@zeroIF
    366	0389  26: C6 87	03C0 31				     mov byte ptr es:[bx + 80d*2*6], '1'
    367	038F			     @@zeroIF:
    368	038F  8B D0					     mov dx, ax
    369	0391  81 E2 0400				     and dx, 0000010000000000b
    370	0395  83 FA 00					     cmp dx, 0
    371	0398  74 06					     je	@@zeroDF
    372	039A  26: C6 87	0460 31				     mov byte ptr es:[bx + 80d*2*7], '1'
    373
    374	03A0			     @@zeroDF:
    375	03A0  C3					     ret
    376	03A1			     printfFlags	     endp
    377				     ;-----------------------------------------------------------------------------------------------
    378				     -
    379				     ;Writes the value of the flags to the video memory
    380				     ;Entry: ax	= register of flags
    381				     ;	     bx	= video	memory offset of the CF
    382				     ;Exit:
    383				     ;Expected:	es contains video memory segment.
    384				     ;Destroyed: bx, cx, dx
    385				     ;-----------------------------------------------------------------------------------------------
    386				     -
    387
    388	03A1			     printfFlagsColumn	     proc
    389
    390	03A1  26: C6 05	63				     mov byte ptr es:[di], 'c'
    391	03A5  26: C6 85	00A0 7A				     mov byte ptr es:[di + 80d*2], 'z'
    392	03AB  26: C6 85	0140 73				     mov byte ptr es:[di + 80d*2*2], 's'
    393	03B1  26: C6 85	01E0 6F				     mov byte ptr es:[di + 80d*2*3], 'o'
    394	03B7  26: C6 85	0280 70				     mov byte ptr es:[di + 80d*2*4], 'p'
    395	03BD  26: C6 85	0320 61				     mov byte ptr es:[di + 80d*2*5], 'a'
    396	03C3  26: C6 85	03C0 69				     mov byte ptr es:[di + 80d*2*6], 'i'
    397	03C9  26: C6 85	0460 64				     mov byte ptr es:[di + 80d*2*7], 'd'
    398
    399	03CF  83 C7 02					     add di, 2
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 8
regist~1.asm



    400	03D2  B0 3D					     mov al, '='
    401	03D4  32 E4					     xor ah, ah
    402	03D6  B9 0008					     mov cx, 8h
    403	03D9  57					     push di
    404	03DA  E8 000F					     call printfVerticalString
    405	03DD  5F					     pop di
    406
    407	03DE  83 C7 02					     add di, 2
    408	03E1  B0 30					     mov al, '0'
    409	03E3  32 E4					     xor ah, ah
    410	03E5  B9 0008					     mov cx, 8h
    411	03E8  E8 0001					     call printfVerticalString
    412
    413	03EB  C3					     ret
    414	03EC			     printfFlagsColumn	     endp
    415				     ;----------------------------------------------------------------------------------------------
    416				     ;Prints a column with processor flags with	zeroed values.
    417				     ;Entry: di	= video	memory offset.
    418				     ;Exit:
    419				     ;Expected:	es contains the	address	of the video memory segment.
    420				     ;Destroyed: ax, bx, cx, di
    421				     ;----------------------------------------------------------------------------------------------
    422
    423	03EC			     printfVerticalString     proc
    424	03EC  BB 00A0					     mov bx, 80d*2
    425	03EF  80 FC 00					     cmp ah, 0
    426	03F2  74 02					     je	@@nextElem
    427	03F4  F7 DB					     neg bx
    428
    429	03F6  26: 88 05		     @@nextElem:	     mov byte ptr es:[di], al
    430	03F9  03 FB					     add di, bx
    431	03FB  E2 F9					     loop @@nextElem
    432
    433	03FD  C3					     ret
    434
    435	03FE			     printfVerticalString     endp
    436				     ;----------------------------------------------------------------------------------------------
    437				     ;Prints vertical string
    438				     ;Entry: al	= symbol binary	code
    439				     ;	     ah	= direction flag (ah = 0, di +=	80d*2; ah != 0,	di -= 80d*2)
    440				     ;	     di	= video	memory offset
    441				     ;	     cx	= length of string
    442				     ;Exit:
    443				     ;Expected:	es contains the	address	of the video memory segment.
    444				     ;Destroyed: cx, bx, di
    445				     ;----------------------------------------------------------------------------------------------
    446
    447
    448	03FE			     printfFrameBackground	     proc
    449	03FE  50						     push ax
    450	03FF  E8 002C						     call getFrameVideoMemoryOffset
    451	0402  58						     pop ax
    452
    453	0403  33 DB						     xor bx, bx
    454	0405  8A DE						     mov bl, dh
    455	0407  80 C3 06						     add bl, 6
    456
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 9
regist~1.asm



    457	040A  33 C9		     printfFrameStr:		     xor cx, cx
    458	040C  8A CA						     mov cl, dl
    459	040E  80 C1 06						     add cl, 6
    460
    461	0411  E8 0044						     call printfFrameBackgroundString
    462
    463	0414  81 C7 00A0					     add di, 160d
    464
    465	0418  50						     push ax
    466	0419  33 C0						     xor ax, ax
    467	041B  8A C2						     mov al, dl
    468	041D  98						     cbw
    469	041E  D1 E0						     shl ax, 1
    470	0420  2B F8						     sub di, ax
    471	0422  83 EF 0C						     sub di, 12
    472	0425  58						     pop ax
    473
    474	0426  FE CB						     dec bl
    475	0428  80 FB 00						     cmp bl, 0
    476	042B  75 DD						     jne printfFrameStr
    477
    478	042D  C3						     ret
    479	042E			     printfFrameBackground	     endp
    480				     ;----------------------------------------------------------------------------------------------
    481				     ;Prints frame centered frame background depending
    482				     ;on the number of lines and their length in the message
    483				     ;Entry: dh	= the number of	lines in the message
    484				     ;	     dl	= max length of	the string in the message
    485				     ;	     al	= frame	color binary code
    486				     ;Exit:
    487				     ;Expected:
    488				     ;Destroyed: bx, di, cl
    489				     ;----------------------------------------------------------------------------------------------
    490
    491
    492	042E			     getFrameVideoMemoryOffset	     proc
    493
    494	042E  BF 0019						     mov di, 25
    495	0431  8A C6						     mov al, dh
    496	0433  98						     cbw
    497	0434  2B F8						     sub di, ax
    498	0436  D1 EF						     shr di, 1
    499	0438  83 EF 03						     sub di, 3d
    500	043B  B8 00A0						     mov ax, 160
    501	043E  52						     push dx
    502	043F  F7 E7						     mul di
    503	0441  5A						     pop dx
    504	0442  8B F8						     mov di, ax
    505
    506	0444  33 C0						     xor ax, ax
    507	0446  8A C2						     mov al, dl
    508	0448  98						     cbw
    509
    510	0449  BB 0050						     mov bx, 80
    511	044C  2B D8						     sub bx, ax
    512	044E  83 EB 06						     sub bx, 6d
    513	0451  D1 EB						     shr bx, 1
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 10
regist~1.asm



    514	0453  D1 E3						     shl bx, 1
    515	0455  03 FB						     add di, bx
    516
    517	0457  C3						     ret
    518	0458			     getFrameVideoMemoryOffset	     endp
    519				     ;----------------------------------------------------------------------------------------------
    520				     ;Gets a video memory offset for frame background depending
    521				     ;on the number of lines and their length in the message
    522				     ;Entry: dh	= the number of	lines in the message
    523				     ;	     dl	= max length of	the string in the message
    524				     ;Exit:  di	= video	memory offset for frame	background
    525				     ;Expected:
    526				     ;Destroyed: ax, bx, di
    527				     ;----------------------------------------------------------------------------------------------
    528
    529
    530	0458			     printfFrameBackgroundString	 proc
    531
    532	0458  26: 88 45	01	     @@printfByte:			 mov byte ptr es:[di+1], al
    533	045C  83 C7 02							 add di, 2
    534	045F  E2 F7							 loop @@printfByte
    535
    536	0461  C3							 ret
    537	0462			     printfFrameBackgroundString	 endp
    538				     ;----------------------------------------------------------------------------------------------
    539				     ;Prints frameBackground string a certain of color
    540				     ;Entry: di	= starting address of the string
    541				     ;	     al	= frame	color binary code
    542				     ;	     cl	= length of the	string
    543				     ;Exit:
    544				     ;Expected:	es contains the	address	of the video memory segment.
    545				     ;Destroyed: di, cl
    546				     ;----------------------------------------------------------------------------------------------
    547
    548	0462			     printfFrameForeground	     proc
    549
    550	0462  81 EF 0140					     sub di, 160*2
    551	0466  83 C7 02						     add di, 2
    552
    553	0469  B0 C8						     mov al, 0C8h
    554	046B  26: 88 05						     mov byte ptr es:[di], al
    555
    556	046E  83 C7 02						     add di, 2
    557
    558	0471  33 C9						     xor cx, cx
    559	0473  8A CA						     mov cl, dl
    560	0475  80 C1 02						     add cl, 2
    561
    562	0478  B0 CD						     mov al, 0CDh
    563	047A  50						     push ax
    564	047B  B4 00						     mov ah, 0
    565	047D  E8 007C						     call printHorizontalString
    566	0480  58						     pop ax
    567
    568	0481  B0 BC						     mov al, 0BCh
    569	0483  26: 88 05						     mov byte ptr es:[di], al
    570
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 11
regist~1.asm



    571	0486  8A C6						     mov al, dh
    572	0488  04 03						     add al, 3
    573	048A  50						     push ax
    574	048B  98						     cbw
    575	048C  BB 00A0						     mov bx, 160d
    576	048F  52						     push dx
    577	0490  F7 E3						     mul bx
    578	0492  5A						     pop dx
    579	0493  2B F8						     sub di, ax
    580	0495  58						     pop ax
    581
    582	0496  B0 BB						     mov al, 0BBh
    583	0498  26: 88 05						     mov byte ptr es:[di], al
    584
    585	049B  83 EF 02						     sub di, 2
    586
    587	049E  33 C9						     xor cx, cx
    588	04A0  8A CA						     mov cl, dl
    589	04A2  80 C1 02						     add cl, 2
    590	04A5  B0 CD						     mov al, 0CDh
    591	04A7  50						     push ax
    592	04A8  B4 01						     mov ah, 1
    593	04AA  E8 004F						     call printHorizontalString
    594	04AD  58						     pop ax
    595
    596	04AE  B0 C9						     mov al, 0C9h
    597	04B0  26: 88 05						     mov byte ptr es:[di], al
    598	04B3  81 C7 00A0					     add di, 80d*2
    599
    600	04B7  8A CE						     mov cl, dh
    601	04B9  80 C1 02						     add cl, 2
    602	04BC  B0 BA						     mov al, 0BAh
    603	04BE  50						     push ax
    604	04BF  B4 00						     mov ah, 0
    605	04C1  E8 FF28						     call printfVerticalString
    606	04C4  58						     pop ax
    607
    608	04C5  81 EF 00A0					     sub di, 80d*2
    609
    610	04C9  50						     push ax
    611	04CA  8A C2						     mov al, dl
    612	04CC  04 03						     add al, 3
    613	04CE  98						     cbw
    614	04CF  D1 E0						     shl ax, 1
    615	04D1  03 F8						     add di, ax
    616	04D3  58						     pop ax
    617
    618	04D4  8A CE						     mov cl, dh
    619	04D6  80 C1 02						     add cl, 2
    620	04D9  B0 BA						     mov al, 0BAh
    621	04DB  50						     push ax
    622	04DC  B4 01						     mov ah, 1
    623	04DE  E8 FF0B						     call printfVerticalString
    624	04E1  58						     pop ax
    625
    626	04E2  81 C7 00A0					     add di, 2*80d
    627	04E6  B0 00						     mov al, 0h
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 12
regist~1.asm



    628	04E8  E8 0023						     call printfInternalFrame
    629
    630	04EB  80 C6 04						     add dh, 4h
    631	04EE  80 C2 04						     add dl, 4h
    632	04F1  81 EF 00A0					     sub di, (80d*2)
    633	04F5  83 C7 06						     add di, 6h
    634	04F8  E8 0013						     call printfInternalFrame
    635
    636	04FB  C3						     ret
    637	04FC			     printfFrameForeground	     endp
    638				     ;----------------------------------------------------------------------------------------------
    639				     ;Prints centered frame foreground depending
    640				     ;on the number of lines and their length in the message
    641				     ;Entry: dh	= the number of	lines in the message
    642				     ;	     dl	= max length of	the string in the message
    643				     ;	     di	= video	memory offset of the lower right corner	of the frame
    644				     ;Exit:
    645				     ;Expected:	es contains the	address	of the video memory segment.
    646				     ;Destroyed: ax, bx, cx, si, di
    647				     ;----------------------------------------------------------------------------------------------
    648
    649
    650	04FC			     printHorizontalString   proc
    651	04FC  BB 0002					     mov bx, 2
    652	04FF  80 FC 00					     cmp ah, 0
    653	0502  74 02					     je	@@nextElem
    654	0504  F7 DB					     neg bx
    655
    656	0506  26: 88 05		     @@nextElem:	     mov byte ptr es:[di], al
    657	0509  03 FB					     add di, bx
    658	050B  E2 F9					     loop @@nextElem
    659
    660	050D  C3					     ret
    661
    662	050E			     printHorizontalString   endp
    663				     ;----------------------------------------------------------------------------------------------
    664				     ;Prints horizontal	string
    665				     ;Entry: al	= symbol binary	code
    666				     ;	     ah	= direction flag (a = 0, di += 2; a != 0, di -=	2)
    667				     ;	     di	= video	memory offset
    668				     ;	     cx	= length of string
    669				     ;Exit:
    670				     ;Expected:	es contains the	address	of the video memory segment.
    671				     ;Destroyed: cx, bx
    672				     ;----------------------------------------------------------------------------------------------
    673
    674	050E			     printfInternalFrame	     proc
    675
    676	050E  83 EF 02						     sub di, 2
    677	0511  8A CA						     mov cl, dl
    678	0513  80 C1 02						     add cl, 2
    679	0516  B4 01						     mov ah, 1
    680	0518  E8 FFE1						     call printHorizontalString
    681
    682	051B  83 C7 02						     add di, 2
    683	051E  8A CE						     mov cl, dh
    684	0520  80 C1 02						     add cl, 2
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 13
regist~1.asm



    685	0523  B4 00						     mov ah, 0
    686	0525  E8 FEC4						     call printfVerticalString
    687
    688	0528  81 EF 00A0					     sub di, 2*80d
    689	052C  8A CA						     mov cl, dl
    690	052E  80 C1 02						     add cl, 2
    691	0531  B4 00						     mov ah, 0
    692	0533  E8 FFC6						     call printHorizontalString
    693
    694	0536  83 EF 02						     sub di, 2
    695	0539  8A CE						     mov cl, dh
    696	053B  80 C1 02						     add cl, 2
    697	053E  B4 01						     mov ah, 1
    698	0540  E8 FEA9						     call printfVerticalString
    699
    700	0543  C3						     ret
    701	0544			     printfInternalFrame	     endp
    702				     ;----------------------------------------------------------------------------------------------
    703				     ;Prints centered internal frame foreground	depending
    704				     ;on the number of lines and their length in the message
    705				     ;Entry: al	= internal frame symbol	ascii-code
    706				     ;	     dh	= the number of	lines in the message
    707				     ;	     dl	= max length of	the string in the message
    708				     ;	     di	= video	memory offset of the upper right corner	of the frame
    709				     ;Exit:
    710				     ;Expected:	es contains the	address	of the video memory segment.
    711				     ;Destroyed: ax, cx, si, di
    712				     ;----------------------------------------------------------------------------------------------
    713
    714	0544			     printfRegistersFrame    proc
    715
    716	0544  E8 FEB7					     call printfFrameBackground
    717
    718	0547  E8 FF18					     call printfFrameForeground
    719
    720	054A  BF 02D4					     mov di, (80d*4+42d)*2
    721	054D  26: C6 05	CB				     mov byte ptr es:[di], 0CBh
    722	0551  81 C7 00A0				     add di, 80d*2
    723	0555  B0 BA					     mov al, 0BAh
    724	0557  32 E4					     xor ah, ah
    725	0559  B9 000F					     mov cx, 15d
    726	055C  E8 FE8D					     call printfVerticalString
    727	055F  26: C6 05	CA				     mov byte ptr es:[di], 0CAh
    728
    729	0563  81 EF 00A2				     sub di, 162d
    730	0567  B0 00					     mov al, 0
    731	0569  B4 01					     mov ah, 1
    732	056B  B9 000F					     mov cx, 15d
    733	056E  E8 FE7B					     call printfVerticalString
    734
    735	0571  81 C7 00A4				     add di, 164d
    736	0575  32 E4					     xor ah, ah
    737	0577  B9 000F					     mov cx, 15d
    738	057A  E8 FE6F					     call printfVerticalString
    739
    740	057D  C3					     ret
    741	057E			     printfRegistersFrame    endp
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 14
regist~1.asm



    742
    743	057E  00		     printfRegsFlag	     db	 0
    744
    745	057F			     endOfProgram:
    746				     end		     Start
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 15
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/25/26"
??FILENAME			  Text	 "regist~1"
??TIME				  Text	 "16:42:51"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@CONTINUE			  Near	 DGROUP:0191
@@END				  Near	 DGROUP:02BA
@@NEXTELEM			  Near	 DGROUP:03F6
@@NEXTELEM			  Near	 DGROUP:0506
@@NORMALMODE			  Near	 DGROUP:012A
@@NOTLETTER1			  Near	 DGROUP:02D1
@@NOTLETTER2			  Near	 DGROUP:02E5
@@NOTLETTER3			  Near	 DGROUP:02F9
@@NOTLETTER4			  Near	 DGROUP:030D
@@PRINTFBYTE			  Near	 DGROUP:0458
@@ZEROAF			  Near	 DGROUP:037E
@@ZEROCF			  Near	 DGROUP:032C
@@ZERODF			  Near	 DGROUP:03A0
@@ZEROIF			  Near	 DGROUP:038F
@@ZEROOF			  Near	 DGROUP:035E
@@ZEROPF			  Near	 DGROUP:036E
@@ZEROSF			  Near	 DGROUP:034D
@@ZEROZF			  Near	 DGROUP:033C
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0707H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 REGIST~1
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
ENDOFPROGRAM			  Near	 DGROUP:057F
ENDRESIDENTPROGRAM		  Near	 DGROUP:010E
GETFRAMEVIDEOMEMORYOFFSET	  Near	 DGROUP:042E
OLD08OFS			  Word	 DGROUP:02BB
OLD08SEG			  Word	 DGROUP:02BD
OLD09OFS			  Word	 DGROUP:013C
OLD09SEG			  Word	 DGROUP:013E
PRINTFFLAGS			  Near	 DGROUP:0312
PRINTFFLAGSCOLUMN		  Near	 DGROUP:03A1
PRINTFFRAMEBACKGROUND		  Near	 DGROUP:03FE
PRINTFFRAMEBACKGROUNDSTRING	  Near	 DGROUP:0458
PRINTFFRAMEFOREGROUND		  Near	 DGROUP:0462
PRINTFFRAMESTR			  Near	 DGROUP:040A
PRINTFHEXREGVALUE		  Near	 DGROUP:02BF
PRINTFINTERNALFRAME		  Near	 DGROUP:050E
PRINTFREGISTERSFRAME		  Near	 DGROUP:0544
PRINTFREGS08INT			  Near	 DGROUP:0186
PRINTFREGSFLAG			  Byte	 DGROUP:057E
PRINTFVERTICALSTRING		  Near	 DGROUP:03EC
PRINTHORIZONTALSTRING		  Near	 DGROUP:04FC
Turbo Assembler	 Version 4.1	    02/25/26 16:42:51	    Page 16
Symbol Table



REGISTERSDEBUGGER09INT		  Near	 DGROUP:011A
REPLACE08INT			  Near	 DGROUP:0163
REPLACE09INT			  Near	 DGROUP:0140
START				  Near	 DGROUP:0100

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  057F Word	  Public  CODE
