Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 1
regist~1.asm



      1				     .286
      2	0000			     .model tiny
      3	0000			     .code
      4				     org 100h
      5				     locals @@
      6
      7	0100			     Start:
      8	0100  E8 003D				     call replace09Int
      9	0103  E8 005D				     call replace08Int
     10
     11	0106  9C				     pushf
     12	0107  0E				     push cs
     13	0108  E8 000F				     call registersDebugger09Int
     14
     15	010B  E8 0000				     call endResidentProgram
     16
     17
     18	010E			     endResidentProgram		 proc
     19
     20	010E  B8 3100						 mov ax, 3100h
     21	0111  BA 0548r						 mov dx, offset	endOfProgram
     22	0114  C1 EA 04						 shr dx, 4
     23	0117  42						 inc dx
     24	0118  CD 21						 int 21h
     25
     26	011A			     endResidentProgram		 endp
     27				     ;-----------------------------------------------------------------------------------------------
     28				     -
     29				     ;Ends resident program.
     30				     ;Entry:
     31				     ;Exit:
     32				     ;Expected:	The label "endOfProgram" is located at the end of the code.
     33				     ;Destroyed: ax, dx
     34				     ;-----------------------------------------------------------------------------------------------
     35				     -
     36
     37	011A			     registersDebugger09Int	 proc
     38	011A  50 53 06						 push ax bx es
     39
     40	011D  E4 60						 in al,	60h
     41	011F  3C 57						 cmp al, 'W'
     42	0121  75 07						 jne @@normalMode
     43	0123  2E: C6 06	0547r 01  +				 mov cs:printfRegsFlag,	1h
     44	      90
     45
     46	012A  E4 61		     @@normalMode:		 in al,	61h
     47	012C  0C 80						 or al,	80h
     48	012E  E6 61						 out 61h, al
     49	0130  24 7F						 and al, not 80h
     50	0132  E6 61						 out 61h, al
     51
     52	0134  B0 20						 mov al, 20h
     53	0136  E6 20						 out 20h, al
     54
     55	0138  07 5B 58						 pop es	bx ax
     56
     57	013B  EA						 db 0eah
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 2
regist~1.asm



     58	013C  0000		     old09ofs			 dw 0
     59	013E  0000		     old09seg			 dw 0
     60
     61	0140			     registersDebugger09Int	 endp
     62				     ;-----------------------------------------------------------------------------------------------
     63				     -
     64				     ;New 09 interrupt,	which raises the printfRegsFlag	to 1, when a key F11 is	pressed.
     65				     ;Entry:
     66				     ;Exit:
     67				     ;Expected:Old 09 interrupt	was replaced to	this function,
     68				     ;old09ofs contains	it's old segment and old09ofs contains it's old	offset.
     69				     ;Destroyed:
     70				     ;-----------------------------------------------------------------------------------------------
     71				     -
     72
     73
     74	0140			     replace09Int		 proc
     75	0140  B8 3509						 mov ax, 3509h
     76	0143  CD 21						 int 21h
     77
     78	0145  89 1E 013Cr					 mov old09ofs, bx
     79	0149  8C C3						 mov bx, es
     80	014B  89 1E 013Er					 mov old09seg, bx
     81
     82	014F  6A 00						 push 0
     83	0151  07						 pop es
     84
     85	0152  BB 0024						 mov bx, 4*09h
     86	0155  FA						 cli
     87	0156  26: C7 07	011Ar					 mov es:[bx], offset registersDebugger09Int
     88	015B  8C C8						 mov ax, cs
     89	015D  26: 89 47	02					 mov es:[bx+2],	ax
     90	0161  FB						 sti
     91
     92	0162  C3						 ret
     93	0163			     replace09Int		 endp
     94				     ;-----------------------------------------------------------------------------------------------
     95				     -
     96				     ;Replaces interrupt 9 with	a function registersDebugger09Int.
     97				     ;Entry:
     98				     ;Exit:
     99				     ;Expected:
    100				     ;Destroyed: ax, bx, es
    101				     ;-----------------------------------------------------------------------------------------------
    102				     -
    103
    104	0163			     replace08Int		 proc
    105
    106	0163  B8 3508						 mov ax, 3508h
    107	0166  CD 21						 int 21h
    108
    109	0168  89 1E 02BEr					 mov old08ofs, bx
    110	016C  8C C3						 mov bx, es
    111	016E  89 1E 02C0r					 mov old08seg, bx
    112
    113	0172  6A 00						 push 0
    114	0174  07						 pop es
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 3
regist~1.asm



    115
    116	0175  BB 0020						 mov bx, 4*08h
    117	0178  FA						 cli
    118	0179  26: C7 07	0186r					 mov es:[bx], offset printfRegs08Int
    119	017E  8C C8						 mov ax, cs
    120	0180  26: 89 47	02					 mov es:[bx+2],	ax
    121	0184  FB						 sti
    122
    123	0185  C3						 ret
    124	0186			     replace08Int		 endp
    125				     ;-----------------------------------------------------------------------------------------------
    126				     -
    127				     ;Replaces interrupt 8 with	a function printfRegs08Int.
    128				     ;Entry:
    129				     ;Exit:
    130				     ;Expected:
    131				     ;Destroyed: ax, bx, es
    132				     ;-----------------------------------------------------------------------------------------------
    133				     -
    134
    135
    136	0186			     printfRegs08Int		 proc
    137	0186  2E: 80 3E	0547r 00				 cmp cs:printfRegsFlag,	0h
    138	018C  75 03						 jne @@continue
    139	018E  E9 012C						 jmp @@end
    140
    141	0191  50 53 51 52 56 57	55+  @@continue:		 push ax bx cx dx si di	bp ds es ss
    142	      1E 06 16
    143	019B  8B EC						 mov bp, sp
    144
    145	019D  68 B800						 push 0b800h
    146	01A0  07						 pop es
    147	01A1  BB 0402						 mov bx, (80d*6+33d)*2
    148
    149	01A4  26: C6 07	61					 mov byte ptr es:[bx], 'a'
    150	01A8  26: C6 47	02 78					 mov byte ptr es:[bx+2], 'x'
    151	01AD  E8 0112						 call printfHexRegValue
    152
    153	01B0  81 C3 00A0					 add bx, 80d*2
    154	01B4  26: C6 07	62					 mov byte ptr es:[bx], 'b'
    155	01B8  26: C6 47	02 78					 mov byte ptr es:[bx+2], 'x'
    156	01BD  8B 46 10						 mov ax, [bp+16]
    157	01C0  E8 00FF						 call printfHexRegValue
    158
    159	01C3  81 C3 00A0					 add bx, 80d*2
    160	01C7  26: C6 07	63					 mov byte ptr es:[bx], 'c'
    161	01CB  26: C6 47	02 78					 mov byte ptr es:[bx+2], 'x'
    162	01D0  8B 46 0E						 mov ax, [bp+14]
    163	01D3  E8 00EC						 call printfHexRegValue
    164
    165	01D6  81 C3 00A0					 add bx, 80d*2
    166	01DA  26: C6 07	64					 mov byte ptr es:[bx], 'd'
    167	01DE  26: C6 47	02 78					 mov byte ptr es:[bx+2], 'x'
    168	01E3  8B 46 0C						 mov ax, [bp+12]
    169	01E6  E8 00D9						 call printfHexRegValue
    170
    171	01E9  81 C3 00A0					 add bx, 80d*2
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 4
regist~1.asm



    172	01ED  26: C6 07	73					 mov byte ptr es:[bx], 's'
    173	01F1  26: C6 47	02 69					 mov byte ptr es:[bx+2], 'i'
    174	01F6  8B 46 0A						 mov ax, [bp+10]
    175	01F9  E8 00C6						 call printfHexRegValue
    176
    177	01FC  81 C3 00A0					 add bx, 80d*2
    178	0200  26: C6 07	64					 mov byte ptr es:[bx], 'd'
    179	0204  26: C6 47	02 69					 mov byte ptr es:[bx+2], 'i'
    180	0209  8B 46 08						 mov ax, [bp+8]
    181	020C  E8 00B3						 call printfHexRegValue
    182
    183	020F  81 C3 00A0					 add bx, 80d*2
    184	0213  26: C6 07	62					 mov byte ptr es:[bx], 'b'
    185	0217  26: C6 47	02 70					 mov byte ptr es:[bx+2], 'p'
    186	021C  8B 46 06						 mov ax, [bp+6]
    187	021F  E8 00A0						 call printfHexRegValue
    188
    189	0222  81 C3 00A0					 add bx, 80d*2
    190	0226  26: C6 07	73					 mov byte ptr es:[bx], 's'
    191	022A  26: C6 47	02 70					 mov byte ptr es:[bx+2], 'p'
    192	022F  8B C4						 mov ax, sp
    193	0231  2D 001A						 sub ax, 13d*2
    194	0234  E8 008B						 call printfHexRegValue
    195
    196	0237  81 C3 00A0					 add bx, 80d*2
    197	023B  26: C6 07	64					 mov byte ptr es:[bx], 'd'
    198	023F  26: C6 47	02 73					 mov byte ptr es:[bx+2], 's'
    199	0244  8B 46 04						 mov ax, [bp+4]
    200	0247  E8 0078						 call printfHexRegValue
    201
    202	024A  81 C3 00A0					 add bx, 80d*2
    203	024E  26: C6 07	65					 mov byte ptr es:[bx], 'e'
    204	0252  26: C6 47	02 73					 mov byte ptr es:[bx+2], 's'
    205	0257  8B 46 02						 mov ax, [bp+2]
    206	025A  E8 0065						 call printfHexRegValue
    207
    208	025D  81 C3 00A0					 add bx, 80d*2
    209	0261  26: C6 07	73					 mov byte ptr es:[bx], 's'
    210	0265  26: C6 47	02 73					 mov byte ptr es:[bx+2], 's'
    211	026A  8B 46 00						 mov ax, [bp]
    212	026D  E8 0052						 call printfHexRegValue
    213
    214	0270  81 C3 00A0					 add bx, 80d*2
    215	0274  26: C6 07	63					 mov byte ptr es:[bx], 'c'
    216	0278  26: C6 47	02 73					 mov byte ptr es:[bx+2], 's'
    217	027D  8B 46 16						 mov ax, [bp+22]
    218	0280  E8 003F						 call printfHexRegValue
    219
    220	0283  81 C3 00A0					 add bx, 80d*2
    221	0287  26: C6 07	69					 mov byte ptr es:[bx], 'i'
    222	028B  26: C6 47	02 70					 mov byte ptr es:[bx+2], 'p'
    223	0290  8B 46 14						 mov ax, [bp+20]
    224	0293  E8 002C						 call printfHexRegValue
    225
    226	0296  8B 46 18						 mov ax, [bp+24]
    227	0299  81 EB 0780					 sub bx, 80d*2*12d
    228	029D  83 C3 16						 add bx, 11d*2
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 5
regist~1.asm



    229	02A0  E8 0072						 call printfFlags
    230
    231	02A3  B6 0D						 mov dh, 13d
    232	02A5  B2 0E						 mov dl, 14d
    233	02A7  B0 30						 mov al, 30h
    234
    235	02A9  E8 0155						 call printfFrameBackground
    236	02AC  E8 01B6						 call printfFrameForeground
    237
    238	02AF  B0 20						 mov al, 20h
    239	02B1  E6 20						 out 20h, al
    240
    241	02B3  17 07 1F 5D 5F 5E	5A+				 pop ss	es ds bp di si dx cx bx	ax
    242	      59 5B 58
    243
    244	02BD  EA		     @@end:			 db 0eah
    245	02BE  0000		     old08ofs			 dw 0
    246	02C0  0000		     old08seg			 dw 0
    247
    248	02C2			     printfRegs08Int		 endp
    249				     ;-----------------------------------------------------------------------------------------------
    250				     -
    251				     ;New 08 interrupt,	which prints the updated values	​​of the processor registers
    252				     ;and flags	in a frame at each tick	of the system timer.
    253				     ;Entry:
    254				     ;Exit:
    255				     ;Expected:Old 08 interrupt	was replaced to	this function,
    256				     ;old08ofs contains	it's old segment and old08ofs contains it's old	offset.
    257				     ;Destroyed:
    258				     ;-----------------------------------------------------------------------------------------------
    259				     -
    260
    261
    262	02C2			     printfHexRegValue		 proc
    263
    264	02C2  33 D2						 xor dx, dx
    265	02C4  8A D4						 mov dl, ah
    266	02C6  C0 EA 04						 shr dl, 4h
    267
    268	02C9  80 C2 30						 add dl, 30h
    269	02CC  80 FA 39						 cmp dl, 39h
    270	02CF  76 03						 jbe @@notLetter1
    271	02D1  80 C2 07						 add dl, 7h
    272
    273	02D4  26: 88 57	06	     @@notLetter1:		 mov byte ptr es:[bx+6], dl
    274
    275	02D8  8A D4						 mov dl, ah
    276	02DA  80 E2 0F						 and dl, 00001111b
    277	02DD  80 C2 30						 add dl, 30h
    278	02E0  80 FA 39						 cmp dl, 39h
    279	02E3  76 03						 jbe @@notLetter2
    280	02E5  80 C2 07						 add dl, 7h
    281
    282	02E8  26: 88 57	08	     @@notLetter2:		 mov byte ptr es:[bx+8], dl
    283
    284	02EC  8A D0						 mov dl, al
    285	02EE  C0 EA 04						 shr dl, 4h
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 6
regist~1.asm



    286
    287	02F1  80 C2 30						 add dl, 30h
    288	02F4  80 FA 39						 cmp dl, 39h
    289	02F7  76 03						 jbe @@notLetter3
    290	02F9  80 C2 07						 add dl, 7h
    291
    292	02FC  26: 88 57	0A	     @@notLetter3:		 mov byte ptr es:[bx+10d], dl
    293
    294	0300  8A D0						 mov dl, al
    295	0302  80 E2 0F						 and dl, 00001111b
    296	0305  80 C2 30						 add dl, 30h
    297	0308  80 FA 39						 cmp dl, 39h
    298	030B  76 03						 jbe @@notLetter4
    299	030D  80 C2 07						 add dl, 7h
    300
    301	0310  26: 88 57	0C	     @@notLetter4:		 mov byte ptr es:[bx+12d], dl
    302
    303	0314  C3						 ret
    304	0315			     printfHexRegValue		 endp
    305				     ;-----------------------------------------------------------------------------------------------
    306				     -
    307				     ;Writes the hexadecimal value of the register to the video	memory
    308				     ;Entry: ax	= current register value
    309				     ;	     bx	= video	memory offset of the beginning of the inscription reduced by 6 bytes
    310				     ;	     (the first	6 bytes	are used to write the register name)
    311				     ;Exit:
    312				     ;Expected:	es contains video memory segment
    313				     ;Destroyed: dx
    314				     ;-----------------------------------------------------------------------------------------------
    315				     -
    316
    317	0315			     printfFlags	     proc
    318
    319	0315  8B FB					     mov di, bx
    320	0317  50 53					     push ax bx
    321	0319  E8 0088					     call printfFlagsColumn
    322	031C  5B 58					     pop bx ax
    323
    324	031E  83 C3 04					     add bx, 4h
    325
    326	0321  8B D0					     mov dx, ax
    327	0323  83 E2 01					     and dx, 0000000000000001b
    328	0326  83 FA 00					     cmp dx, 0
    329	0329  74 04					     je	@@zeroCF
    330	032B  26: C6 07	31				     mov byte ptr es:[bx], '1'
    331	032F			     @@zeroCF:
    332
    333	032F  8B D0					     mov dx, ax
    334	0331  83 E2 40					     and dx, 0000000001000000b
    335	0334  83 FA 00					     cmp dx, 0
    336	0337  74 06					     je	@@zeroZF
    337	0339  26: C6 87	00A0 31				     mov byte ptr es:[bx + 80d*2], '1'
    338	033F			     @@zeroZF:
    339	033F  8B D0					     mov dx, ax
    340	0341  81 E2 0080				     and dx, 0000000010000000b
    341	0345  83 FA 00					     cmp dx, 0
    342	0348  74 06					     je	@@zeroSF
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 7
regist~1.asm



    343	034A  26: C6 87	0140 31				     mov byte ptr es:[bx + 80d*2*2], '1'
    344	0350			     @@zeroSF:
    345	0350  8B D0					     mov dx, ax
    346	0352  81 E2 0800				     and dx, 0000100000000000b
    347	0356  83 FA 00					     cmp dx, 0
    348	0359  74 06					     je	@@zeroOF
    349	035B  26: C6 87	01E0 31				     mov byte ptr es:[bx + 80d*2*3], '1'
    350	0361			     @@zeroOF:
    351	0361  8B D0					     mov dx, ax
    352	0363  83 E2 04					     and dx, 0000000000000100b
    353	0366  83 FA 00					     cmp dx, 0
    354	0369  74 06					     je	@@zeroPF
    355	036B  26: C6 87	0280 31				     mov byte ptr es:[bx + 80d*2*4], '1'
    356	0371			     @@zeroPF:
    357	0371  8B D0					     mov dx, ax
    358	0373  83 E2 10					     and dx, 0000000000010000b
    359	0376  83 FA 00					     cmp dx, 0
    360	0379  74 06					     je	@@zeroAF
    361	037B  26: C6 87	0320 31				     mov byte ptr es:[bx + 80d*2*5], '1'
    362	0381			     @@zeroAF:
    363	0381  8B D0					     mov dx, ax
    364	0383  81 E2 0200				     and dx, 0000001000000000b
    365	0387  83 FA 00					     cmp dx, 0
    366	038A  74 06					     je	@@zeroIF
    367	038C  26: C6 87	03C0 31				     mov byte ptr es:[bx + 80d*2*6], '1'
    368	0392			     @@zeroIF:
    369	0392  8B D0					     mov dx, ax
    370	0394  81 E2 0400				     and dx, 0000010000000000b
    371	0398  83 FA 00					     cmp dx, 0
    372	039B  74 06					     je	@@zeroDF
    373	039D  26: C6 87	0460 31				     mov byte ptr es:[bx + 80d*2*7], '1'
    374
    375	03A3			     @@zeroDF:
    376	03A3  C3					     ret
    377	03A4			     printfFlags	     endp
    378				     ;-----------------------------------------------------------------------------------------------
    379				     -
    380				     ;Writes the value of the flags to the video memory
    381				     ;Entry: ax	= register of flags
    382				     ;	     bx	= video	memory offset of the CF
    383				     ;Exit:
    384				     ;Expected:	es contains video memory segment.
    385				     ;Destroyed: bx, cx, dx
    386				     ;-----------------------------------------------------------------------------------------------
    387				     -
    388
    389	03A4			     printfFlagsColumn	     proc
    390
    391	03A4  26: C6 05	63				     mov byte ptr es:[di], 'c'
    392	03A8  26: C6 85	00A0 7A				     mov byte ptr es:[di + 80d*2], 'z'
    393	03AE  26: C6 85	0140 73				     mov byte ptr es:[di + 80d*2*2], 's'
    394	03B4  26: C6 85	01E0 6F				     mov byte ptr es:[di + 80d*2*3], 'o'
    395	03BA  26: C6 85	0280 70				     mov byte ptr es:[di + 80d*2*4], 'p'
    396	03C0  26: C6 85	0320 61				     mov byte ptr es:[di + 80d*2*5], 'a'
    397	03C6  26: C6 85	03C0 69				     mov byte ptr es:[di + 80d*2*6], 'i'
    398	03CC  26: C6 85	0460 64				     mov byte ptr es:[di + 80d*2*7], 'd'
    399
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 8
regist~1.asm



    400	03D2  83 C7 02					     add di, 2
    401	03D5  B0 3D					     mov al, '='
    402	03D7  32 E4					     xor ah, ah
    403	03D9  B9 0008					     mov cx, 8h
    404	03DC  57					     push di
    405	03DD  E8 000F					     call printVerticalString
    406	03E0  5F					     pop di
    407
    408	03E1  83 C7 02					     add di, 2
    409	03E4  B0 30					     mov al, '0'
    410	03E6  32 E4					     xor ah, ah
    411	03E8  B9 0008					     mov cx, 8h
    412	03EB  E8 0001					     call printVerticalString
    413
    414	03EE  C3					     ret
    415	03EF			     printfFlagsColumn	     endp
    416				     ;----------------------------------------------------------------------------------------------
    417				     ;Prints a column with processor flags with	zeroed values.
    418				     ;Entry: di	= video	memory offset.
    419				     ;Exit:
    420				     ;Expected:	es contains the	address	of the video memory segment.
    421				     ;Destroyed: ax, bx, cx, di
    422				     ;----------------------------------------------------------------------------------------------
    423
    424	03EF			     printVerticalString     proc
    425	03EF  BB 00A0					     mov bx, 80d*2
    426	03F2  80 FC 00					     cmp ah, 0
    427	03F5  74 02					     je	@@nextElem
    428	03F7  F7 DB					     neg bx
    429
    430	03F9  26: 88 05		     @@nextElem:	     mov byte ptr es:[di], al
    431	03FC  03 FB					     add di, bx
    432	03FE  E2 F9					     loop @@nextElem
    433
    434	0400  C3					     ret
    435
    436	0401			     printVerticalString     endp
    437				     ;----------------------------------------------------------------------------------------------
    438				     ;Prints vertical string
    439				     ;Entry: al	= symbol binary	code
    440				     ;	     ah	= direction flag (ah = 0, di +=	80d*2; ah != 0,	di -= 80d*2)
    441				     ;	     di	= video	memory offset
    442				     ;	     cx	= length of string
    443				     ;Exit:
    444				     ;Expected:	es contains the	address	of the video memory segment.
    445				     ;Destroyed: cx, bx, di
    446				     ;----------------------------------------------------------------------------------------------
    447
    448
    449	0401			     printfFrameBackground	     proc
    450	0401  50						     push ax
    451	0402  E8 002C						     call getFrameVideoMemoryOffset
    452	0405  58						     pop ax
    453
    454	0406  33 DB						     xor bx, bx
    455	0408  8A DE						     mov bl, dh
    456	040A  80 C3 06						     add bl, 6
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 9
regist~1.asm



    457
    458	040D  33 C9		     printfFrameStr:		     xor cx, cx
    459	040F  8A CA						     mov cl, dl
    460	0411  80 C1 06						     add cl, 6
    461
    462	0414  E8 0044						     call printfFrameBackgroundString
    463
    464	0417  81 C7 00A0					     add di, 160d
    465
    466	041B  50						     push ax
    467	041C  33 C0						     xor ax, ax
    468	041E  8A C2						     mov al, dl
    469	0420  98						     cbw
    470	0421  D1 E0						     shl ax, 1
    471	0423  2B F8						     sub di, ax
    472	0425  83 EF 0C						     sub di, 12
    473	0428  58						     pop ax
    474
    475	0429  FE CB						     dec bl
    476	042B  80 FB 00						     cmp bl, 0
    477	042E  75 DD						     jne printfFrameStr
    478
    479	0430  C3						     ret
    480	0431			     printfFrameBackground	     endp
    481				     ;----------------------------------------------------------------------------------------------
    482				     ;Prints frame centered frame background depending
    483				     ;on the number of lines and their length in the message
    484				     ;Entry: dh	= the number of	lines in the message
    485				     ;	     dl	= max length of	the string in the message
    486				     ;	     al	= frame	color binary code
    487				     ;Exit:
    488				     ;Expected:
    489				     ;Destroyed: bx, di, cl
    490				     ;----------------------------------------------------------------------------------------------
    491
    492
    493	0431			     getFrameVideoMemoryOffset	     proc
    494
    495	0431  BF 0019						     mov di, 25
    496	0434  8A C6						     mov al, dh
    497	0436  98						     cbw
    498	0437  2B F8						     sub di, ax
    499	0439  D1 EF						     shr di, 1
    500	043B  83 EF 03						     sub di, 3d
    501	043E  B8 00A0						     mov ax, 160
    502	0441  52						     push dx
    503	0442  F7 E7						     mul di
    504	0444  5A						     pop dx
    505	0445  8B F8						     mov di, ax
    506
    507	0447  33 C0						     xor ax, ax
    508	0449  8A C2						     mov al, dl
    509	044B  98						     cbw
    510
    511	044C  BB 0050						     mov bx, 80
    512	044F  2B D8						     sub bx, ax
    513	0451  83 EB 06						     sub bx, 6d
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 10
regist~1.asm



    514	0454  D1 EB						     shr bx, 1
    515	0456  D1 E3						     shl bx, 1
    516	0458  03 FB						     add di, bx
    517
    518	045A  C3						     ret
    519	045B			     getFrameVideoMemoryOffset	     endp
    520				     ;----------------------------------------------------------------------------------------------
    521				     ;Gets a video memory offset for frame background depending
    522				     ;on the number of lines and their length in the message
    523				     ;Entry: dh	= the number of	lines in the message
    524				     ;	     dl	= max length of	the string in the message
    525				     ;Exit:  di	= video	memory offset for frame	background
    526				     ;Expected:
    527				     ;Destroyed: ax, bx, di
    528				     ;----------------------------------------------------------------------------------------------
    529
    530
    531	045B			     printfFrameBackgroundString	 proc
    532
    533	045B  26: 88 45	01	     @@printfByte:			 mov byte ptr es:[di+1], al
    534	045F  83 C7 02							 add di, 2
    535	0462  E2 F7							 loop @@printfByte
    536
    537	0464  C3							 ret
    538	0465			     printfFrameBackgroundString	 endp
    539				     ;----------------------------------------------------------------------------------------------
    540				     ;Prints frameBackground string a certain of color
    541				     ;Entry: di	= starting address of the string
    542				     ;	     al	= frame	color binary code
    543				     ;	     cl	= length of the	string
    544				     ;Exit:
    545				     ;Expected:	es contains the	address	of the video memory segment.
    546				     ;Destroyed: di, cl
    547				     ;----------------------------------------------------------------------------------------------
    548
    549	0465			     printfFrameForeground	     proc
    550
    551	0465  81 EF 0140					     sub di, 160*2
    552	0469  83 C7 02						     add di, 2
    553
    554	046C  B0 C8						     mov al, 0C8h
    555	046E  26: 88 05						     mov byte ptr es:[di], al
    556
    557	0471  83 C7 02						     add di, 2
    558
    559	0474  33 C9						     xor cx, cx
    560	0476  8A CA						     mov cl, dl
    561	0478  80 C1 02						     add cl, 2
    562
    563	047B  B0 CD						     mov al, 0CDh
    564	047D  50						     push ax
    565	047E  B4 00						     mov ah, 0
    566	0480  E8 007C						     call printHorizontalString
    567	0483  58						     pop ax
    568
    569	0484  B0 BC						     mov al, 0BCh
    570	0486  26: 88 05						     mov byte ptr es:[di], al
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 11
regist~1.asm



    571
    572	0489  8A C6						     mov al, dh
    573	048B  04 03						     add al, 3
    574	048D  50						     push ax
    575	048E  98						     cbw
    576	048F  BB 00A0						     mov bx, 160d
    577	0492  52						     push dx
    578	0493  F7 E3						     mul bx
    579	0495  5A						     pop dx
    580	0496  2B F8						     sub di, ax
    581	0498  58						     pop ax
    582
    583	0499  B0 BB						     mov al, 0BBh
    584	049B  26: 88 05						     mov byte ptr es:[di], al
    585
    586	049E  83 EF 02						     sub di, 2
    587
    588	04A1  33 C9						     xor cx, cx
    589	04A3  8A CA						     mov cl, dl
    590	04A5  80 C1 02						     add cl, 2
    591	04A8  B0 CD						     mov al, 0CDh
    592	04AA  50						     push ax
    593	04AB  B4 01						     mov ah, 1
    594	04AD  E8 004F						     call printHorizontalString
    595	04B0  58						     pop ax
    596
    597	04B1  B0 C9						     mov al, 0C9h
    598	04B3  26: 88 05						     mov byte ptr es:[di], al
    599	04B6  81 C7 00A0					     add di, 80d*2
    600
    601	04BA  8A CE						     mov cl, dh
    602	04BC  80 C1 02						     add cl, 2
    603	04BF  B0 BA						     mov al, 0BAh
    604	04C1  50						     push ax
    605	04C2  B4 00						     mov ah, 0
    606	04C4  E8 FF28						     call printVerticalString
    607	04C7  58						     pop ax
    608
    609	04C8  81 EF 00A0					     sub di, 80d*2
    610
    611	04CC  50						     push ax
    612	04CD  8A C2						     mov al, dl
    613	04CF  04 03						     add al, 3
    614	04D1  98						     cbw
    615	04D2  D1 E0						     shl ax, 1
    616	04D4  03 F8						     add di, ax
    617	04D6  58						     pop ax
    618
    619	04D7  8A CE						     mov cl, dh
    620	04D9  80 C1 02						     add cl, 2
    621	04DC  B0 BA						     mov al, 0BAh
    622	04DE  50						     push ax
    623	04DF  B4 01						     mov ah, 1
    624	04E1  E8 FF0B						     call printVerticalString
    625	04E4  58						     pop ax
    626
    627	04E5  81 C7 00A0					     add di, 2*80d
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 12
regist~1.asm



    628	04E9  B0 00						     mov al, 0h
    629	04EB  E8 0023						     call printfInternalFrame
    630
    631	04EE  80 C6 04						     add dh, 4h
    632	04F1  80 C2 04						     add dl, 4h
    633	04F4  81 EF 00A0					     sub di, (80d*2)
    634	04F8  83 C7 06						     add di, 6h
    635	04FB  E8 0013						     call printfInternalFrame
    636
    637	04FE  C3						     ret
    638	04FF			     printfFrameForeground	     endp
    639				     ;----------------------------------------------------------------------------------------------
    640				     ;Prints centered frame foreground depending
    641				     ;on the number of lines and their length in the message
    642				     ;Entry: dh	= the number of	lines in the message
    643				     ;	     dl	= max length of	the string in the message
    644				     ;	     di	= video	memory offset of the lower right corner	of the frame
    645				     ;Exit:
    646				     ;Expected:	es contains the	address	of the video memory segment.
    647				     ;Destroyed: ax, bx, cx, si, di
    648				     ;----------------------------------------------------------------------------------------------
    649
    650
    651	04FF			     printHorizontalString   proc
    652	04FF  BB 0002					     mov bx, 2
    653	0502  80 FC 00					     cmp ah, 0
    654	0505  74 02					     je	@@nextElem
    655	0507  F7 DB					     neg bx
    656
    657	0509  26: 88 05		     @@nextElem:	     mov byte ptr es:[di], al
    658	050C  03 FB					     add di, bx
    659	050E  E2 F9					     loop @@nextElem
    660
    661	0510  C3					     ret
    662
    663	0511			     printHorizontalString   endp
    664				     ;----------------------------------------------------------------------------------------------
    665				     ;Prints horizontal	string
    666				     ;Entry: al	= symbol binary	code
    667				     ;	     ah	= direction flag (a = 0, di += 2; a != 0, di -=	2)
    668				     ;	     di	= video	memory offset
    669				     ;	     cx	= length of string
    670				     ;Exit:
    671				     ;Expected:	es contains the	address	of the video memory segment.
    672				     ;Destroyed: cx, bx
    673				     ;----------------------------------------------------------------------------------------------
    674
    675	0511			     printfInternalFrame	     proc
    676
    677	0511  83 EF 02						     sub di, 2
    678	0514  8A CA						     mov cl, dl
    679	0516  80 C1 02						     add cl, 2
    680	0519  B4 01						     mov ah, 1
    681	051B  E8 FFE1						     call printHorizontalString
    682
    683	051E  83 C7 02						     add di, 2
    684	0521  8A CE						     mov cl, dh
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 13
regist~1.asm



    685	0523  80 C1 02						     add cl, 2
    686	0526  B4 00						     mov ah, 0
    687	0528  E8 FEC4						     call printVerticalString
    688
    689	052B  81 EF 00A0					     sub di, 2*80d
    690	052F  8A CA						     mov cl, dl
    691	0531  80 C1 02						     add cl, 2
    692	0534  B4 00						     mov ah, 0
    693	0536  E8 FFC6						     call printHorizontalString
    694
    695	0539  83 EF 02						     sub di, 2
    696	053C  8A CE						     mov cl, dh
    697	053E  80 C1 02						     add cl, 2
    698	0541  B4 01						     mov ah, 1
    699	0543  E8 FEA9						     call printVerticalString
    700
    701	0546  C3						     ret
    702	0547			     printfInternalFrame	     endp
    703				     ;----------------------------------------------------------------------------------------------
    704				     ;Prints centered internal frame foreground	depending
    705				     ;on the number of lines and their length in the message
    706				     ;Entry: al	= internal frame symbol	ascii-code
    707				     ;	     dh	= the number of	lines in the message
    708				     ;	     dl	= max length of	the string in the message
    709				     ;	     di	= video	memory offset of the upper right corner	of the frame
    710				     ;Exit:
    711				     ;Expected:	es contains the	address	of the video memory segment.
    712				     ;Destroyed: ax, cx, si, di
    713				     ;----------------------------------------------------------------------------------------------
    714
    715	0547  00		     printfRegsFlag	     db	 0
    716
    717	0548			     endOfProgram:
    718				     end		     Start
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 14
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/23/26"
??FILENAME			  Text	 "regist~1"
??TIME				  Text	 "23:46:52"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@CONTINUE			  Near	 DGROUP:0191
@@END				  Near	 DGROUP:02BD
@@NEXTELEM			  Near	 DGROUP:03F9
@@NEXTELEM			  Near	 DGROUP:0509
@@NORMALMODE			  Near	 DGROUP:012A
@@NOTLETTER1			  Near	 DGROUP:02D4
@@NOTLETTER2			  Near	 DGROUP:02E8
@@NOTLETTER3			  Near	 DGROUP:02FC
@@NOTLETTER4			  Near	 DGROUP:0310
@@PRINTFBYTE			  Near	 DGROUP:045B
@@ZEROAF			  Near	 DGROUP:0381
@@ZEROCF			  Near	 DGROUP:032F
@@ZERODF			  Near	 DGROUP:03A3
@@ZEROIF			  Near	 DGROUP:0392
@@ZEROOF			  Near	 DGROUP:0361
@@ZEROPF			  Near	 DGROUP:0371
@@ZEROSF			  Near	 DGROUP:0350
@@ZEROZF			  Near	 DGROUP:033F
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0707H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 REGIST~1
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
ENDOFPROGRAM			  Near	 DGROUP:0548
ENDRESIDENTPROGRAM		  Near	 DGROUP:010E
GETFRAMEVIDEOMEMORYOFFSET	  Near	 DGROUP:0431
OLD08OFS			  Word	 DGROUP:02BE
OLD08SEG			  Word	 DGROUP:02C0
OLD09OFS			  Word	 DGROUP:013C
OLD09SEG			  Word	 DGROUP:013E
PRINTFFLAGS			  Near	 DGROUP:0315
PRINTFFLAGSCOLUMN		  Near	 DGROUP:03A4
PRINTFFRAMEBACKGROUND		  Near	 DGROUP:0401
PRINTFFRAMEBACKGROUNDSTRING	  Near	 DGROUP:045B
PRINTFFRAMEFOREGROUND		  Near	 DGROUP:0465
PRINTFFRAMESTR			  Near	 DGROUP:040D
PRINTFHEXREGVALUE		  Near	 DGROUP:02C2
PRINTFINTERNALFRAME		  Near	 DGROUP:0511
PRINTFREGS08INT			  Near	 DGROUP:0186
PRINTFREGSFLAG			  Byte	 DGROUP:0547
PRINTHORIZONTALSTRING		  Near	 DGROUP:04FF
PRINTVERTICALSTRING		  Near	 DGROUP:03EF
REGISTERSDEBUGGER09INT		  Near	 DGROUP:011A
Turbo Assembler	 Version 4.1	    02/23/26 23:46:53	    Page 15
Symbol Table



REPLACE08INT			  Near	 DGROUP:0163
REPLACE09INT			  Near	 DGROUP:0140
START				  Near	 DGROUP:0100

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  0548 Word	  Public  CODE
